clarifai model local-runner
[INFO] 11:23:11.406057 Detected OpenAI chat completions for Clarifai model streaming - validating stream_options... |  thread=8821432512 
[ERROR] 11:23:11.406350 Missing configuration to track usage for OpenAI chat completion calls. Go to your model scripts and make sure to set both: 1) stream_options={'include_usage': True}2) set_output_context |  thread=8821432512 
[INFO] 11:23:11.406705 > Checking local runner requirements... |  thread=8821432512 
[INFO] 11:23:11.428851 Checking 2 dependencies... |  thread=8821432512 
[INFO] 11:23:11.429253 ✅ All 2 dependencies are installed! |  thread=8821432512 
[INFO] 11:23:11.431322 > Verifying local runner setup... |  thread=8821432512 
[INFO] 11:23:11.431374 Current context: default |  thread=8821432512 
[INFO] 11:23:11.431406 Current user_id: alfrick |  thread=8821432512 
[INFO] 11:23:11.431432 Current PAT: d6974**** |  thread=8821432512 
[INFO] 11:23:11.433893 Current compute_cluster_id: local-runner-compute-cluster |  thread=8821432512 
[WARNING] 11:23:14.002018 Failed to get compute cluster with ID 'local-runner-compute-cluster':
code: CONN_DOES_NOT_EXIST
description: "Resource does not exist"
details: "ComputeCluster with ID \'local-runner-compute-cluster\' not found. Check your request fields."
req_id: "sdk-python-11.10.2-34a60189eb514b8b9085ba741a13a7ca"
 |  thread=8821432512 
Compute cluster not found. Do you want to create a new compute cluster alfrick/local-runner-compute-cluster? (y/n): y
[INFO] 11:23:26.498698 Compute Cluster with ID 'local-runner-compute-cluster' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-a3c367c30482463aa0f23089d8971d7a"
 |  thread=8821432512 
[INFO] 11:23:26.508120 Current nodepool_id: local-runner-nodepool |  thread=8821432512 
[WARNING] 11:23:29.251200 Failed to get nodepool with ID 'local-runner-nodepool':
code: CONN_DOES_NOT_EXIST
description: "Resource does not exist"
details: "Nodepool not found. Check your request fields."
req_id: "sdk-python-11.10.2-c841763ca1d54452984432a6642ec030"
 |  thread=8821432512 
Nodepool not found. Do you want to create a new nodepool alfrick/local-runner-compute-cluster/local-runner-nodepool? (y/n): y
[INFO] 11:23:32.994964 Nodepool with ID 'local-runner-nodepool' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-0cd9f37bc175431aa57626ac709b6490"
 |  thread=8821432512 
[INFO] 11:23:33.009030 Current app_id: local-runner-app |  thread=8821432512 
[WARNING] 11:23:33.330525 Failed to get app with ID 'local-runner-app':
code: CONN_DOES_NOT_EXIST
description: "Resource does not exist"
details: "app identified by path /users/alfrick/apps/local-runner-app not found"
req_id: "sdk-python-11.10.2-05940fc72d46478d8309275b3ccf788e"
 |  thread=8821432512 
App not found. Do you want to create a new app alfrick/local-runner-app? (y/n): y
[INFO] 11:23:36.874801 App with ID 'local-runner-app' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-da9c70e006774b7a9ab5ae47b339cd6d"
 |  thread=8821432512 
[INFO] 11:23:36.887817 Current model_id: local-runner-model |  thread=8821432512 
[WARNING] 11:23:38.066408 Failed to get model with ID 'local-runner-model':
code: MODEL_DOES_NOT_EXIST
description: "Model does not exist"
details: "Model \'local-runner-model\' does not exist."
req_id: "sdk-python-11.10.2-a2157a2599f747559e1f9fcc1d459247"
 |  thread=8821432512 
Model not found. Do you want to create a new model alfrick/local-runner-app/models/local-runner-model? (y/n): y
[INFO] 11:23:42.481867 Model with ID 'local-runner-model' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-a2949b4d81304deda6cb897a05b89cfd"
 |  thread=8821432512 
[WARNING] 11:23:44.422210 No model versions found. Creating a new version for local runner. |  thread=8821432512 
[INFO] 11:23:45.628623 Model Version with ID '36bde5dcf7c24317a08d1366a8cc5757' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-1cf881046e2047b795533c4f08da5c7e"
 |  thread=8821432512 
[INFO] 11:23:46.723898 Current model version 36bde5dcf7c24317a08d1366a8cc5757 |  thread=8821432512 
[INFO] 11:23:46.724179 Creating the local runner tying this 'alfrick/local-runner-app/models/local-runner-model' model (version: 36bde5dcf7c24317a08d1366a8cc5757) to the 'alfrick/local-runner-compute-cluster/local-runner-nodepool' nodepool. |  thread=8821432512 
[INFO] 11:23:48.660432 Runner with ID '805fa3de93d341d7aaac0aed94786236' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-a613867263b94219ba9fc558f29c1661"
 |  thread=8821432512 
[INFO] 11:23:48.670950 Current runner_id: 805fa3de93d341d7aaac0aed94786236 |  thread=8821432512 
[WARNING] 11:23:48.931127 Failed to get deployment with ID local-runner-deployment:
code: CONN_DOES_NOT_EXIST
description: "Resource does not exist"
details: "Deployment with ID \'local-runner-deployment\' not found. Check your request fields."
req_id: "sdk-python-11.10.2-28999059cf6e42b4ab868dcca10b4201"
 |  thread=8821432512 
Deployment not found. Do you want to create a new deployment alfrick/local-runner-compute-cluster/local-runner-nodepool/local-runner-deployment? (y/n): y
[INFO] 11:23:53.891169 Deployment with ID 'local-runner-deployment' is created:
code: SUCCESS
description: "Ok"
req_id: "sdk-python-11.10.2-8a6701fa26e64acc8109e6affef1df28"
 |  thread=8821432512 
[INFO] 11:23:53.902286 Current deployment_id: local-runner-deployment |  thread=8821432512 
[INFO] 11:23:53.902438 Current model section of config.yaml: {'id': 'my-model', 'user_id': 'alfrick', 'app_id': 'app_id', 'model_type_id': 'any-to-any'} |  thread=8821432512 
Do you want to backup config.yaml to config.yaml.bk then update the config.yaml with the new model information? (y/n): y
[INFO] 11:23:57.187239 Checking 2 dependencies... |  thread=8821432512 
[INFO] 11:23:57.188280 ✅ All 2 dependencies are installed! |  thread=8821432512 
[INFO] 11:23:57.188387 ✅ Starting local runner... |  thread=8821432512 
[INFO] 11:23:57.188475 No secrets path configured, running without secrets |  thread=8821432512 
[INFO] 11:23:58.334211 Detected OpenAI chat completions for Clarifai model streaming - validating stream_options... |  thread=8821432512 
[ERROR] 11:23:58.334788 Missing configuration to track usage for OpenAI chat completion calls. Go to your model scripts and make sure to set both: 1) stream_options={'include_usage': True}2) set_output_context |  thread=8821432512 
[INFO] 11:23:58.358199 ModelServer initialized successfully |  thread=8821432512 
[INFO] 11:23:58.385791 ✅ Your model is running locally and is ready for requests from the API...
 |  thread=8821432512 
[INFO] 11:23:58.385872 > Code Snippet: To call your model via the API, use this code snippet:

import os

from openai import OpenAI

client = OpenAI(
    base_url="https://api.clarifai.com/v2/ext/openai/v1",
    api_key=os.environ['CLARIFAI_PAT'],
)

response = client.chat.completions.create(
    model="https://clarifai.com/alfrick/local-runner-app/models/local-runner-model",
    messages=[
        {"role": "system", "content": "Talk like a pirate."},
        {
            "role": "user",
            "content": "How do I check if a Python object is an instance of a class?",
        },
    ],
    temperature=1.0,
    stream=False,  # stream=True also works, just iterator over the response
)
print(response)
 |  thread=8821432512 
[INFO] 11:23:58.385916 > Playground:   To chat with your model, visit: https://clarifai.com/playground?model=local-runner-model__36bde5dcf7c24317a08d1366a8cc5757&user_id=alfrick&app_id=local-runner-app
 |  thread=8821432512 
[INFO] 11:23:58.385946 > API URL:      To call your model via the API, use this model URL: https://clarifai.com/alfrick/local-runner-app/models/local-runner-model
 |  thread=8821432512 
[INFO] 11:23:58.385966 Press CTRL+C to stop the runner.
 |  thread=8821432512 
[INFO] 11:23:58.385994 Starting 32 threads... |  thread=8821432512 