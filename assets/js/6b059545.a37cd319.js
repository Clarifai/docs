"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[2789],{11470:(e,n,a)=>{a.d(n,{A:()=>j});var t=a(96540),i=a(18215),r=a(17559),o=a(23104),s=a(56347),l=a(205),c=a(57485),u=a(31682),d=a(70679);function h(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:a}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:a,default:t}})=>({value:e,label:n,attributes:a,default:t}))}(a);return function(e){const n=(0,u.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,a])}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const a=(0,s.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(i),(0,t.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(a.location.search);n.set(i,e),a.replace({...a.location,search:n.toString()})},[i,a])]}function b(e){const{defaultValue:n,queryString:a=!1,groupId:i}=e,r=p(e),[o,s]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find(e=>e.default)??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r})),[c,u]=m({queryString:a,groupId:i}),[h,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,i]=(0,d.Dv)(n);return[a,(0,t.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),_=(()=>{const e=c??h;return f({value:e,tabValues:r})?e:null})();(0,l.A)(()=>{_&&s(_)},[_]);return{selectedValue:o,selectValue:(0,t.useCallback)(e=>{if(!f({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),b(e)},[u,b,r]),tabValues:r}}var _=a(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var A=a(74848);function v({className:e,block:n,selectedValue:a,selectValue:t,tabValues:r}){const s=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,i=s.indexOf(n),o=r[i].value;o!==a&&(l(n),t(o))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=s.indexOf(e.currentTarget)+1;n=s[a]??s[0];break}case"ArrowLeft":{const a=s.indexOf(e.currentTarget)-1;n=s[a]??s[s.length-1];break}}n?.focus()};return(0,A.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:t})=>(0,A.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{s.push(e)},onKeyDown:u,onClick:c,...t,className:(0,i.A)("tabs__item",y.tabItem,t?.className,{"tabs__item--active":a===e}),children:n??e},e))})}function I({lazy:e,children:n,selectedValue:a}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===a);return e?(0,t.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,A.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function g(e){const n=b(e);return(0,A.jsxs)("div",{className:(0,i.A)(r.G.tabs.container,"tabs-container",y.tabList),children:[(0,A.jsx)(v,{...n,...e}),(0,A.jsx)(I,{...n,...e})]})}function j(e){const n=(0,_.A)();return(0,A.jsx)(g,{...e,children:h(e.children)},String(n))}},19365:(e,n,a)=>{a.d(n,{A:()=>o});a(96540);var t=a(18215);const i={tabItem:"tabItem_Ymn6"};var r=a(74848);function o({children:e,hidden:n,className:a}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(i.tabItem,a),hidden:n,children:e})}},31734:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>f,contentTitle:()=>p,default:()=>_,frontMatter:()=>h,metadata:()=>t,toc:()=>m});const t=JSON.parse('{"id":"integrations/databricks/fetch-annotations","title":"Fetch Annotations","description":"Seamlessly retrieve annotations from Clarifai into Databricks","source":"@site/docs/integrations/databricks/fetch-annotations.md","sourceDirName":"integrations/databricks","slug":"/integrations/databricks/fetch-annotations","permalink":"/integrations/databricks/fetch-annotations","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"description":"Seamlessly retrieve annotations from Clarifai into Databricks","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Fetch Data","permalink":"/integrations/databricks/fetch-data"},"next":{"title":"Databricks-Connect Module","permalink":"/integrations/databricks/databricks-connect"}}');var i=a(74848),r=a(28453),o=a(11470),s=a(19365),l=a(88149);const c='######################################################################################\n# In this section, we set the user authentication, user and app ID, and dataset ID.\n# Change these strings to run your own example.\n#####################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# Specify the dataset\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Retrieve annotations in JSON format\nannotations_response = list(dataset_obj.list_annotations(input_ids=None))\n\nprint(annotations_response)\n',u='######################################################################################\n# In this section, we set the user authentication, user and app ID, and dataset ID.\n# Change these strings to run your own example.\n######################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# Specify the dataset\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Retrieve annotations as a dataframe\nannotations_df = dataset_obj.export_annotations_to_dataframe(input_ids=None)\n\nprint(annotations_df)\n',d='#####################################################################################\n# In this section, we set the user authentication, user and app ID, and dataset ID.\n# Change these strings to run your own example.\n#####################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# Specify the dataset\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Retrieve inputs with annotations as a dataframe\ndataset_df = dataset_obj.export_dataset_to_dataframe(\n          input_type="image"  # Or, specify as "text"\n)\n\nprint(dataset_df)\n',h={description:"Seamlessly retrieve annotations from Clarifai into Databricks",sidebar_position:3},p="Fetch Annotations",f={},m=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Retrieve Annotations in JSON Format",id:"retrieve-annotations-in-json-format",level:2},{value:"Retrieve Annotations as a Dataframe",id:"retrieve-annotations-as-a-dataframe",level:2},{value:"Retrieve Inputs With Annotations as a Dataframe",id:"retrieve-inputs-with-annotations-as-a-dataframe",level:3}];function b(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"fetch-annotations",children:"Fetch Annotations"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Seamlessly retrieve annotations from Clarifai into Databricks"})}),"\n",(0,i.jsx)("hr",{}),"\n",(0,i.jsxs)(n.p,{children:["The Clarifai platform allows you to ",(0,i.jsx)(n.a,{href:"https://docs.clarifai.com/portal-guide/annotate/create-get-update-delete",children:"annotate your inputs"}),", enriching them with valuable labels and metadata."]}),"\n",(0,i.jsx)(n.p,{children:"You can effortlessly fetch annotations from a Clarifai application to Databricks. This integration is particularly valuable for machine learning workflows in Databricks, as it introduces annotated data from Clarifai into the platform."}),"\n",(0,i.jsx)(n.p,{children:"Annotated data enhances the quality of training data, a crucial factor in improving the accuracy and performance of machine learning models."}),"\n",(0,i.jsx)(n.p,{children:"Let\u2019s illustrate how you can seamlessly transfer annotations from Clarifai into the Databricks environment."}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Databricks notebook development environment"}),"\n",(0,i.jsxs)(n.li,{children:["Get your PAT (Personal Access Token) from the Clarifai\u2019s portal under the ",(0,i.jsx)(n.a,{href:"https://clarifai.com/settings/security",children:"Settings/Security"})," section"]}),"\n",(0,i.jsx)(n.li,{children:"Get your Clarifai user ID"}),"\n",(0,i.jsx)(n.li,{children:"Get the ID of the Clarifai app where you want to fetch the annotations from"}),"\n",(0,i.jsx)(n.li,{children:"Get the ID of the dataset having the annotations within your app"}),"\n",(0,i.jsxs)(n.li,{children:["Install the ",(0,i.jsx)(n.a,{href:"https://github.com/Clarifai/clarifai-pyspark",children:"Clarifai PySpark"})," package by running ",(0,i.jsx)(n.code,{children:"pip install clarifai-pyspark "})]}),"\n",(0,i.jsxs)(n.li,{children:["Install Protocol Buffers by running ",(0,i.jsx)(n.code,{children:"pip install protobuf==4.24.2 "}),". It\u2019s a cross-platform, serialization protocol that describes the structure of the data to be sent"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["You can learn how to authenticate with the Clarifai platform ",(0,i.jsx)(n.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"here"}),"."]})}),"\n","\n","\n",(0,i.jsx)(n.h2,{id:"retrieve-annotations-in-json-format",children:"Retrieve Annotations in JSON Format"}),"\n",(0,i.jsx)(n.p,{children:"You can retrieve detailed information about the annotations in your Clarifai app\u2019s dataset. You\u2019ll get a JSON response containing comprehensive details about the annotations."}),"\n",(0,i.jsx)(n.p,{children:"Optionally, you can specify a list of input IDs for which you want to fetch their annotations."}),"\n",(0,i.jsx)(o.A,{groupId:"code",children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:c})})}),"\n",(0,i.jsx)(n.h2,{id:"retrieve-annotations-as-a-dataframe",children:"Retrieve Annotations as a Dataframe"}),"\n",(0,i.jsxs)(n.p,{children:["You can retrieve detailed information about your annotations in a structured dataframe format. The dataframe includes key columns like ",(0,i.jsx)(n.code,{children:"annotation_id"}),", ",(0,i.jsx)(n.code,{children:"annotation"}),", ",(0,i.jsx)(n.code,{children:"annotation_user_id"}),", ",(0,i.jsx)(n.code,{children:"input_id"}),", ",(0,i.jsx)(n.code,{children:"annotation_created_at"})," and ",(0,i.jsx)(n.code,{children:"annotation_modified_at"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Note that the JSON response may include supplementary attributes, offering comprehensive insights beyond the specified columns in the dataframe."}),"\n",(0,i.jsx)(n.p,{children:"Optionally, you can specify a list of input IDs for which you want to fetch their annotations."}),"\n",(0,i.jsx)(o.A,{groupId:"code",children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:u})})}),"\n",(0,i.jsx)(n.h3,{id:"retrieve-inputs-with-annotations-as-a-dataframe",children:"Retrieve Inputs With Annotations as a Dataframe"}),"\n",(0,i.jsx)(n.p,{children:"You can obtain inputs along with their corresponding annotations in a structured dataframe. This capability allows for the simultaneous retrieval of input details and their associated annotations."}),"\n",(0,i.jsx)(n.p,{children:"The resulting dataframe consolidates information seamlessly from both the annotations and inputs dataframes, as outlined in the previously mentioned functions."}),"\n",(0,i.jsx)(o.A,{groupId:"code",children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:d})})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["You can get examples for integrating Clarifai with Databricks ",(0,i.jsx)(n.a,{href:"https://github.com/Clarifai/clarifai-pyspark/tree/main/examples",children:"here"}),"."]})})]})}function _(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(b,{...e})}):b(e)}}}]);