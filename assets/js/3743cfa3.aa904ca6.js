"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[3141],{8975:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>_,contentTitle:()=>m,default:()=>y,frontMatter:()=>f,metadata:()=>n,toc:()=>b});const n=JSON.parse('{"id":"integrations/databricks/upload-data","title":"Upload Data","description":"Seamlessly upload your data from Databricks into Clarifai","source":"@site/docs/integrations/databricks/upload-data.md","sourceDirName":"integrations/databricks","slug":"/integrations/databricks/upload-data","permalink":"/integrations/databricks/upload-data","draft":false,"unlisted":false,"editUrl":"https://github.com/Clarifai/docs/blob/main/docs/integrations/databricks/upload-data.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"description":"Seamlessly upload your data from Databricks into Clarifai","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Integrating Clarifai With Databricks","permalink":"/integrations/databricks/"},"next":{"title":"Fetch Data","permalink":"/integrations/databricks/fetch-data"}}');var r=t(74848),i=t(28453),o=t(65537),s=t(79329),l=t(58069);const c='###################################################################################\n# In this section, we set the user authentication, user and app ID, dataset ID,\n# and Databricks folder path. Change these strings to run your own example.\n##################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n# URL path of your Databricks folder; Example: "/Volumes/test1/default/volume1/folder1"\nFOLDER_PATH = "YOUR_DATABRICKS_FOLDER_PATH_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# This creates a new dataset in the app if it doesn\'t already exist\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Upload from a volume folder\ndataset_obj.upload_dataset_from_folder(\n    folder_path=FOLDER_PATH,\n    input_type="image",\n    # input_type="text", # Or, specify to upload text data\n    labels=False,  # Set to True if the folder name serves as the label for all the images within it\n)\n',d='###################################################################################\n# In this section, we set the user authentication, user and app ID, dataset ID,\n# and Databricks CSV path. Change these strings to run your own example.\n##################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n# URL path of your Databricks CSV file; Example: "/Volumes/test1/default/volume1/SMS_train_1.csv"\nCSV_PATH = "YOUR_DATABRICKS_CSV_PATH_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# This creates a new dataset in the app if it doesn\'t already exist\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Upload from CSV\ndataset_obj.upload_dataset_from_csv(\n    csv_path=CSV_PATH,\n    input_type="text",\n    # input_type="image", # Or, specify to upload image data\n    labels=False,  # Set to True if "concepts" column exists\n    csv_type="raw",  # Or, specify as "url" or "filepath"\n    source="volume",  # Specify as "s3" to use a CSV file directly from your AWS S3 bucket\n)\n',u='################################################################################### \n# In this section, we set the user authentication, user and app ID, dataset ID,\n# and Databricks delta table path. Change these strings to run your own example.\n##################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n# URL path of your Databricks delta table \nTABLE_PATH = "YOUR_DATABRICKS_TABLE_PATH_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# This creates a new dataset in the app if it doesn\'t already exist\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Upload from delta table\ndataset_obj.upload_dataset_from_table(\n    table_path=TABLE_PATH,\n    input_type="text",\n    # input_type="image", # Or, specify to upload image data\n    labels=False,  # Set to True if "concepts" column exists\n    table_type="raw", # Or, specify as "url" or "filepath"     \n)\n',p='######################################################################################\n# In this section, we set the user authentication, user and app ID, and dataset ID. \n# Change these strings to run your own example.\n#####################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# This creates a new dataset in the app if it doesn\'t already exist\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Upload from dataframe\ndataset_obj.upload_dataset_from_dataframe(\n    dataframe=spark_dataframe,\n    input_type="text",\n    # input_type="image", # Or, specify to upload image data\n    labels=False,  # Set to True if "concepts" column exists\n    csv_type="raw", # Or, specify as "url" or "filepath"     \n)\n',h='################################################################################### \n# In this section, we set the user authentication, user and app ID, dataset ID, \n# and volume module path. Change these strings to run your own example.\n##################################################################################\n\n# Your PAT (Personal Access Token) can be found in the Account\'s Security section\nPAT = "YOUR_PAT_HERE"\nUSER_ID = "YOUR_USER_ID_HERE"\nAPP_ID = "YOUR_APP_ID_HERE"\nDATASET_ID = "YOUR_DATASET_ID_HERE"\n# URL path of your Databricks volume\nVOLUME_MODULE_PATH = "YOUR_VOLUME_MODULE_PATH_HERE"\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\n# Import the required packages\nimport os\nfrom clarifaipyspark.client import ClarifaiPySpark\n\n# Set Clarifai PAT as environment variable\nos.environ["CLARIFAI_PAT"] = PAT\n# Create a Clarifai-PySpark client object to connect to your app on Clarifai\ncspark_obj = ClarifaiPySpark(user_id=USER_ID, app_id=APP_ID)\n# This creates a new dataset in the app if it doesn\'t already exist\ndataset_obj = cspark_obj.dataset(dataset_id=DATASET_ID)\n\n#  Upload with custom dataloader\ndataset_obj.upload_dataset_from_dataloader(\n    task="visual-classification",\n    split ="train",\n    module_dir=VOLUME_MODULE_PATH\n  )\n',f={description:"Seamlessly upload your data from Databricks into Clarifai",sidebar_position:1},m="Upload Data",_={},b=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Upload Data From a Volume Folder",id:"upload-data-from-a-volume-folder",level:2},{value:"Upload Data From CSV",id:"upload-data-from-csv",level:2},{value:"Upload From Delta Table",id:"upload-from-delta-table",level:2},{value:"Upload From Dataframe",id:"upload-from-dataframe",level:2},{value:"Upload With Custom Dataloader",id:"upload-with-custom-dataloader",level:2}];function A(a){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...a.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"upload-data",children:"Upload Data"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Seamlessly upload your data from Databricks into Clarifai"})}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(e.p,{children:"You can ingest datasets from Databricks into your Clarifai environment. This allows you to easily take advantage of Clarifai's AI capabilities to analyze and extract insights from your data, without having to manually move it between the two platforms."}),"\n",(0,r.jsxs)(e.p,{children:["Once your data has been uploaded to Clarifai, you can leverage Clarifai\u2019s AI capabilities to get the most out of your data. For example, you can use Clarifai to identify and classify ",(0,r.jsx)(e.a,{href:"https://docs.clarifai.com/portal-guide/annotate/create-get-update-delete/",children:"objects and scenes"})," in images."]}),"\n",(0,r.jsxs)(e.p,{children:["Let\u2019s illustrate how you can seamlessly transfer data from a Databricks ",(0,r.jsx)(e.a,{href:"https://docs.databricks.com/en/sql/language-manual/sql-ref-volumes.html",children:"volume"})," to Clarifai."]}),"\n",(0,r.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Databricks notebook development environment. Also, ensure your Databricks workspace is enabled to work with ",(0,r.jsx)(e.a,{href:"https://docs.databricks.com/en/data-governance/unity-catalog/get-started.html",children:"Unity Catalog"})]}),"\n",(0,r.jsx)(e.li,{children:"Get the path URL of the Databricks location having your data"}),"\n",(0,r.jsxs)(e.li,{children:["Get your PAT (Personal Access Token) from the Clarifai\u2019s portal under the ",(0,r.jsx)(e.a,{href:"https://clarifai.com/settings/security",children:"Settings/Security"})," section"]}),"\n",(0,r.jsx)(e.li,{children:"Get your Clarifai user ID"}),"\n",(0,r.jsx)(e.li,{children:"Get the ID of the Clarifai app where you want to upload the data"}),"\n",(0,r.jsx)(e.li,{children:"Get the ID of a dataset within your app"}),"\n",(0,r.jsxs)(e.li,{children:["Install the ",(0,r.jsx)(e.a,{href:"https://github.com/Clarifai/clarifai-pyspark",children:"Clarifai PySpark"})," package by running ",(0,r.jsx)(e.code,{children:"pip install clarifai-pyspark "})]}),"\n",(0,r.jsxs)(e.li,{children:["Install Protocol Buffers by running ",(0,r.jsx)(e.code,{children:"pip install protobuf==4.24.2 "}),". It\u2019s a cross-platform, serialization protocol that describes the structure of the data to be sent"]}),"\n"]}),"\n",(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsxs)(e.p,{children:["You can learn how to authenticate with the Clarifai platform ",(0,r.jsx)(e.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"here"}),"."]})}),"\n","\n","\n",(0,r.jsx)(e.h2,{id:"upload-data-from-a-volume-folder",children:"Upload Data From a Volume Folder"}),"\n",(0,r.jsx)(e.p,{children:"You can upload images or text files stored in a Databricks volume to your Clarifai application. It\u2019s important to ensure that the folder exclusively contains either images or text files."}),"\n",(0,r.jsx)(o.A,{children:(0,r.jsx)(s.A,{value:"python",label:"Python",children:(0,r.jsx)(l.A,{className:"language-python",children:c})})}),"\n",(0,r.jsx)(e.h2,{id:"upload-data-from-csv",children:"Upload Data From CSV"}),"\n",(0,r.jsxs)(e.p,{children:["You can upload data from a CSV file stored in a Databricks volume to your Clarifai application. The CSV file must include two essential columns: ",(0,r.jsx)(e.code,{children:"inputid"})," and ",(0,r.jsx)(e.code,{children:"input"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:["You can also include additional supported columns such as ",(0,r.jsx)(e.code,{children:"concepts"}),", ",(0,r.jsx)(e.code,{children:"metadata"}),", and ",(0,r.jsx)(e.code,{children:"geopoints"}),". The ",(0,r.jsx)(e.code,{children:"input"})," column within the CSV is a versatile field, capable of accommodating either a file URL or path, or it can contain raw text."]}),"\n",(0,r.jsx)(o.A,{children:(0,r.jsx)(s.A,{value:"python",label:"Python",children:(0,r.jsx)(l.A,{className:"language-python",children:d})})}),"\n",(0,r.jsx)(e.h2,{id:"upload-from-delta-table",children:"Upload From Delta Table"}),"\n",(0,r.jsxs)(e.p,{children:["You can upload data from a delta table in a Databricks volume to your Clarifai application. The table must include two essential columns: ",(0,r.jsx)(e.code,{children:"inputid"})," and ",(0,r.jsx)(e.code,{children:"input"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:["You can also include additional supported columns such as ",(0,r.jsx)(e.code,{children:"concepts"}),", ",(0,r.jsx)(e.code,{children:"metadata"}),", and ",(0,r.jsx)(e.code,{children:"geopoints"}),". The ",(0,r.jsx)(e.code,{children:"input"})," column within the table is a versatile field, capable of accommodating either a file URL or path, or it can contain raw text."]}),"\n",(0,r.jsx)(o.A,{children:(0,r.jsx)(s.A,{value:"python",label:"Python",children:(0,r.jsx)(l.A,{className:"language-python",children:u})})}),"\n",(0,r.jsx)(e.h2,{id:"upload-from-dataframe",children:"Upload From Dataframe"}),"\n",(0,r.jsxs)(e.p,{children:["You can upload data from a PySpark dataframe in a Databricks volume to your Clarifai application. The dataframe must include two essential columns: ",(0,r.jsx)(e.code,{children:"inputid"})," and ",(0,r.jsx)(e.code,{children:"input"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:["You can also include additional supported columns such as ",(0,r.jsx)(e.code,{children:"concepts"}),", ",(0,r.jsx)(e.code,{children:"metadata"}),", and ",(0,r.jsx)(e.code,{children:"geopoints"}),". The ",(0,r.jsx)(e.code,{children:"input"})," column within the table is a versatile field, capable of accommodating either a file URL or path, or it can contain raw text."]}),"\n",(0,r.jsx)(o.A,{children:(0,r.jsx)(s.A,{value:"python",label:"Python",children:(0,r.jsx)(l.A,{className:"language-python",children:p})})}),"\n",(0,r.jsx)(e.h2,{id:"upload-with-custom-dataloader",children:"Upload With Custom Dataloader"}),"\n",(0,r.jsx)(e.p,{children:"You can utilize the custom data loader option if your dataset is stored in an alternative format or necessitates preprocessing. This grants you the flexibility to provide a specialized data loader tailored to your specific requirements."}),"\n",(0,r.jsxs)(e.p,{children:["For reference, you can explore a variety of data loader examples ",(0,r.jsx)(e.a,{href:"https://github.com/Clarifai/examples/tree/main/datasets/upload",children:"here"}),"."]}),"\n",(0,r.jsx)(e.p,{children:"Ensure that the necessary files and folders for the dataloader are stored in Databricks volume storage to facilitate seamless integration and accessibility."}),"\n",(0,r.jsx)(o.A,{children:(0,r.jsx)(s.A,{value:"python",label:"Python",children:(0,r.jsx)(l.A,{className:"language-python",children:h})})}),"\n",(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsxs)(e.p,{children:["You can get examples for integrating Clarifai with Databricks ",(0,r.jsx)(e.a,{href:"https://github.com/Clarifai/clarifai-pyspark/tree/main/examples",children:"here"}),"."]})})]})}function y(a={}){const{wrapper:e}={...(0,i.R)(),...a.components};return e?(0,r.jsx)(e,{...a,children:(0,r.jsx)(A,{...a})}):A(a)}},65537:(a,e,t)=>{t.d(e,{A:()=>D});var n=t(96540),r=t(18215),i=t(65627),o=t(56347),s=t(50372),l=t(30604),c=t(11861),d=t(78749);function u(a){return n.Children.toArray(a).filter((a=>"\n"!==a)).map((a=>{if(!a||(0,n.isValidElement)(a)&&function(a){const{props:e}=a;return!!e&&"object"==typeof e&&"value"in e}(a))return a;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof a.type?a.type:a.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(a){const{values:e,children:t}=a;return(0,n.useMemo)((()=>{const a=e??function(a){return u(a).map((a=>{let{props:{value:e,label:t,attributes:n,default:r}}=a;return{value:e,label:t,attributes:n,default:r}}))}(t);return function(a){const e=(0,c.XI)(a,((a,e)=>a.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((a=>a.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(a),a}),[e,t])}function h(a){let{value:e,tabValues:t}=a;return t.some((a=>a.value===e))}function f(a){let{queryString:e=!1,groupId:t}=a;const r=(0,o.W6)(),i=function(a){let{queryString:e=!1,groupId:t}=a;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,l.aZ)(i),(0,n.useCallback)((a=>{if(!i)return;const e=new URLSearchParams(r.location.search);e.set(i,a),r.replace({...r.location,search:e.toString()})}),[i,r])]}function m(a){const{defaultValue:e,queryString:t=!1,groupId:r}=a,i=p(a),[o,l]=(0,n.useState)((()=>function(a){let{defaultValue:e,tabValues:t}=a;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map((a=>a.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find((a=>a.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:e,tabValues:i}))),[c,u]=f({queryString:t,groupId:r}),[m,_]=function(a){let{groupId:e}=a;const t=function(a){return a?`docusaurus.tab.${a}`:null}(e),[r,i]=(0,d.Dv)(t);return[r,(0,n.useCallback)((a=>{t&&i.set(a)}),[t,i])]}({groupId:r}),b=(()=>{const a=c??m;return h({value:a,tabValues:i})?a:null})();(0,s.A)((()=>{b&&l(b)}),[b]);return{selectedValue:o,selectValue:(0,n.useCallback)((a=>{if(!h({value:a,tabValues:i}))throw new Error(`Can't select invalid tab value=${a}`);l(a),u(a),_(a)}),[u,_,i]),tabValues:i}}var _=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var A=t(74848);function y(a){let{className:e,block:t,selectedValue:n,selectValue:o,tabValues:s}=a;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=a=>{const e=a.currentTarget,t=l.indexOf(e),r=s[t].value;r!==n&&(c(e),o(r))},u=a=>{let e=null;switch(a.key){case"Enter":d(a);break;case"ArrowRight":{const t=l.indexOf(a.currentTarget)+1;e=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(a.currentTarget)-1;e=l[t]??l[l.length-1];break}}e?.focus()};return(0,A.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},e),children:s.map((a=>{let{value:e,label:t,attributes:i}=a;return(0,A.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:a=>{l.push(a)},onKeyDown:u,onClick:d,...i,className:(0,r.A)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":n===e}),children:t??e},e)}))})}function T(a){let{lazy:e,children:t,selectedValue:i}=a;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const a=o.find((a=>a.props.value===i));return a?(0,n.cloneElement)(a,{className:(0,r.A)("margin-top--md",a.props.className)}):null}return(0,A.jsx)("div",{className:"margin-top--md",children:o.map(((a,e)=>(0,n.cloneElement)(a,{key:e,hidden:a.props.value!==i})))})}function E(a){const e=m(a);return(0,A.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,A.jsx)(y,{...e,...a}),(0,A.jsx)(T,{...e,...a})]})}function D(a){const e=(0,_.A)();return(0,A.jsx)(E,{...a,children:u(a.children)},String(e))}},79329:(a,e,t)=>{t.d(e,{A:()=>o});t(96540);var n=t(18215);const r={tabItem:"tabItem_Ymn6"};var i=t(74848);function o(a){let{children:e,hidden:t,className:o}=a;return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.A)(r.tabItem,o),hidden:t,children:e})}}}]);