"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[160],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(a),u=o,m=p["".concat(s,".").concat(u)]||p[u]||h[u]||i;return a?n.createElement(m,r(r({ref:t},c),{},{components:a})):n.createElement(m,r({ref:t},c))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=a[d];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},5107:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var n=a(87462),o=(a(67294),a(3905));const i={description:"Frequently asked questions on model training and evaluation",sidebar_position:6},r="Model Training and Evaluation FAQs",l={unversionedId:"portal-guide/model/training-evaluation-faqs",id:"portal-guide/model/training-evaluation-faqs",title:"Model Training and Evaluation FAQs",description:"Frequently asked questions on model training and evaluation",source:"@site/docs/portal-guide/model/training-evaluation-faqs.md",sourceDirName:"portal-guide/model",slug:"/portal-guide/model/training-evaluation-faqs",permalink:"/portal-guide/model/training-evaluation-faqs",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{description:"Frequently asked questions on model training and evaluation",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Deep Training",permalink:"/portal-guide/model/deep-training"},next:{title:"Creating and Managing Model Versions",permalink:"/portal-guide/model-versions/"}},s={},d=[{value:"Framing the right problem: what should I predict?",id:"framing-the-right-problem-what-should-i-predict",level:2},{value:"What are the key steps in the model building process?",id:"what-are-the-key-steps-in-the-model-building-process",level:2},{value:"What are the differences between the various model types?",id:"what-are-the-differences-between-the-various-model-types",level:2},{value:"What is a \u201cgood\u201d training dataset, and how do data quality and quantity affect model performance?",id:"what-is-a-good-training-dataset-and-how-do-data-quality-and-quantity-affect-model-performance",level:2},{value:"What is the difference between bias and variance in model training?",id:"what-is-the-difference-between-bias-and-variance-in-model-training",level:2},{value:"How can I improve concept performance?",id:"how-can-i-improve-concept-performance",level:2},{value:"Is there a checklist I can use for training custom models?",id:"is-there-a-checklist-i-can-use-for-training-custom-models",level:2},{value:"What is \u201cground truth\u201d and how do we use it to dictate model building?",id:"what-is-ground-truth-and-how-do-we-use-it-to-dictate-model-building",level:2},{value:"How do we train for closed-set and open-set recognition?",id:"how-do-we-train-for-closed-set-and-open-set-recognition",level:2},{value:"What is the ROC AUC score, and how does it relate to prediction accuracy?",id:"what-is-the-roc-auc-score-and-how-does-it-relate-to-prediction-accuracy",level:2},{value:"How do we read a concept-by-concept matrix?",id:"how-do-we-read-a-concept-by-concept-matrix",level:2},{value:"Along with AUC, what other insights can a confusion matrix provide?",id:"along-with-auc-what-other-insights-can-a-confusion-matrix-provide",level:2},{value:"How can I improve a model by drilling down to \u201cproblematic cells\u201d in a confusion matrix?",id:"how-can-i-improve-a-model-by-drilling-down-to-problematic-cells-in-a-confusion-matrix",level:2},{value:"What is the importance of recall and precision rate?",id:"what-is-the-importance-of-recall-and-precision-rate",level:2},{value:"How do we choose a prediction threshold?",id:"how-do-we-choose-a-prediction-threshold",level:2},{value:"Once a model is trained and evaluated, how do we determine its accuracy?",id:"once-a-model-is-trained-and-evaluated-how-do-we-determine-its-accuracy",level:2}],c={toc:d},p="wrapper";function h(e){let{components:t,...i}=e;return(0,o.kt)(p,(0,n.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"model-training-and-evaluation-faqs"},"Model Training and Evaluation FAQs"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Frequently asked questions on model training and evaluation")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"framing-the-right-problem-what-should-i-predict"},"Framing the right problem: what should I predict?"),(0,o.kt)("p",null,"It\u2019s critical to create visually distinctive concepts with a curated taxonomy (aka oncology) based on the business problem, data collected, and success measures derived from model performance metrics.  "),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"framing the right problem",src:a(59116).Z,width:"338",height:"334"})),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"framing the right problem concepts",src:a(34990).Z,width:"348",height:"532"}))))),(0,o.kt)("p",null,"For example, if you take a look at the above image marked with client metadata, you can see that the data was labeled for the presence of something, rather than the subject of the entire image. "),(0,o.kt)("p",null,"This is perfect for humans, but definitely not a scenario in which a model would easily discern concepts."),(0,o.kt)("h2",{id:"what-are-the-key-steps-in-the-model-building-process"},"What are the key steps in the model building process?"),(0,o.kt)("p",null,"These are the six key steps in the process for building new models:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Gathering data"),"\u2014Involves collecting data either from Clarifai\u2019s data reserves or collecting your own unique datasets."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Building a visual dictionary"),"\u2014Involves defining the process and the success criteria."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Preparing or \u2018cleaning\u2019 the data"),"\u2014This step prepares the data for use in training the model. You can recognize important variables or visual features, and check for data imbalances that could impact the predictions of your model."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Training the model"),"\u2014Involves using a process called training to \u201cteach\u201d the model what it will eventually predict on, based on the data you prepared. This happens over many interactions, improving accuracy."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Evaluating or testing the model"),"\u2014Similar to how someone learns any skill, practice makes perfect, and this step involves using evaluation data that the model has never seen before to test its effectiveness."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Tuning parameters"),"\u2014Often considered more of an art than a hard-and-fast scientific or mathematical ruling, this step involves choosing the best prediction thresholds, or parameters, to determine what is a \u201ccorrect\u201d or \u201cincorrect\u201d prediction.")),(0,o.kt)("h2",{id:"what-are-the-differences-between-the-various-model-types"},"What are the differences between the various model types?"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Visual classification model"),"\u2014Predicts and then assigns classification of one or more objects | ",(0,o.kt)("em",{parentName:"p"},"\u201cThis is an image of an eagle and an octopus.\u201d"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Visual detection model"),"\u2014Given an image, allows a user to classify and find the location of an object | ",(0,o.kt)("em",{parentName:"p"},"\u201cThe octopus is located at this bounding box in the image.\u201d"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Visual search model"),"\u2014Allows a user to detect an object or subject in different scenarios and settings, and then define the object | ",(0,o.kt)("em",{parentName:"p"},"\u201cI will use this image of an octopus to find other octopuses.\u201d"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Visual segmentation model"),"\u2014Given an image, allows a user to find all pixels (instead of a bounding box in the case of detection model) | ",(0,o.kt)("em",{parentName:"p"},"\u201cThe octopus\u2019s precise shape (aka mask) is defined by all pixels in the image.\u201d"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Visual anomaly model"),"\u2014Allow users to find anomalous examples with only normal examples in training | ",(0,o.kt)("em",{parentName:"p"},"\u201cI will find an octopus holding spaghetti and meatballs among all images of octopuses (with very similar ocean background).\u201d"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Text classification model"),"\u2014Given a piece of a text passage, allows a user to classify one or more categories | ",(0,o.kt)("em",{parentName:"p"},"\u201cOctopus is very intelligent\u201d = good; \u201cOctopus is very stupid\u201d = bad")))),(0,o.kt)("h2",{id:"what-is-a-good-training-dataset-and-how-do-data-quality-and-quantity-affect-model-performance"},"What is a \u201cgood\u201d training dataset, and how do data quality and quantity affect model performance?"),(0,o.kt)("p",null,"A training dataset refers to the data that is used as positive inputs for concepts in a model. A \u201cgood\u201d training dataset will set the model to make predictions as close to the world as a user would see it.  "),(0,o.kt)("p",null,"Data ",(0,o.kt)("strong",{parentName:"p"},"quality"),", in the context of machine learning, is data that:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"visually adheres to concept descriptions laid out in a taxonomy, and;"),(0,o.kt)("li",{parentName:"ul"},"reflects the expected user\u2019s data for the model\u2019s intended use case.")),(0,o.kt)("p",null,"Data ",(0,o.kt)("strong",{parentName:"p"},"quantity")," casts a wider net for model understanding. With more data, we can be more specific and more granular with our concepts."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example:")),(0,o.kt)("p",null,"For a Guinness beer\u2019s \u201cPerfect Pint\u201d model, the client had a few thousand images of professionally photographed pints of beer in different stages of pour appearance on bar tops taken in daylight. The model was meant to see a photo of a pint of beer, and return a judgment on how the pint of beer looks compared to the \u201cperfect\u201d looking pint of beer."),(0,o.kt)("p",null,"Unfortunately, because the images used to initially train the model did not look ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("strong",{parentName:"em"},"qualitatively"))," similar to the user-generated content (UGC), ",(0,o.kt)("strong",{parentName:"p"},"and")," the user data was photographed in ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("strong",{parentName:"em"},"more"))," scenarios than bars, the model needed improvement in the form of:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"1) more data to capture the breadth of scenarios, and;"),(0,o.kt)("li",{parentName:"ul"},"2) data that reflected the quality of smartphone cameras. ")),(0,o.kt)("p",null,"After applying these changes, the model performance improved."),(0,o.kt)("h2",{id:"what-is-the-difference-between-bias-and-variance-in-model-training"},"What is the difference between bias and variance in model training?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Bias")," occurs when the scope of your training data is ",(0,o.kt)("em",{parentName:"p"},"too narrow.")," If you only see green apples, you\u2019ll assume that all apples are green and think red apples are another kind of fruit. If the training data contains only a small number of examples, it\u2019ll react accordingly, taking it as truth. Small datasets make for a smaller worldview."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Variance"),", on the other hand, occurs when your training set is ",(0,o.kt)("em",{parentName:"p"},"cast too wide.")," If you train a concept of too many different kinds of images, and they are all visually different, the training set will become noisy. This will make it difficult for the model to find visually distinct qualities to learn from. "),(0,o.kt)("p",null,"The key to avoiding both of these pitfalls is building a dataset with the quality ",(0,o.kt)("em",{parentName:"p"},"and")," quantity of content kept in mind. "),(0,o.kt)("h2",{id:"how-can-i-improve-concept-performance"},"How can I improve concept performance?"),(0,o.kt)("p",null,"Concepts that perform well tend to be the ones that are annotated in images photographed in a consistent and unique way. "),(0,o.kt)("p",null,"Concepts that tend to perform poorly are those:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"a) trained on data with inconsistent compositions;"),(0,o.kt)("li",{parentName:"ul"},"b) the photos require outside context (relationships to people in portraits, etc.); and/or,"),(0,o.kt)("li",{parentName:"ul"},"c) the subject matter is subtle.")),(0,o.kt)("p",null,"Keep in mind the model has no concept of language; so, in essence, \u201cwhat you see is what you get.\u201d"),(0,o.kt)("p",null,"Let\u2019s take a case of a false positive prediction made by a model in the process of training to recognize wedding imagery."),(0,o.kt)("p",null,"Here is an example of an image of a married couple, which had a ",(0,o.kt)("strong",{parentName:"p"},"false positive")," prediction for a person holding a bouquet of flowers, even though there is no bouquet in the photo. "),(0,o.kt)("p",null,"What\u2019s going on here?"),(0,o.kt)("p",null," ",(0,o.kt)("img",{alt:"concept performance",src:a(53560).Z,width:"1080",height:"720"})),(0,o.kt)("p",null,"A photo\u2019s composition and the combination of elements therein could confuse a model."),(0,o.kt)("p",null,"All the images below were labeled with the ",(0,o.kt)("strong",{parentName:"p"},"\u2018Bouquet_Floral_Holding\u2019")," concept. "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"images for concept performance",src:a(88812).Z,width:"1600",height:"858"})),(0,o.kt)("p",null,"In this very rare instance, the image in question has:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A ",(0,o.kt)("em",{parentName:"li"},"veiled")," bride"),(0,o.kt)("li",{parentName:"ul"},"The bride & groom kissing/their heads close together"),(0,o.kt)("li",{parentName:"ul"},"Greenery over their heads"),(0,o.kt)("li",{parentName:"ul"},"Large, recognizable flowers")),(0,o.kt)("p",null,"The model sees ",(0,o.kt)("em",{parentName:"p"},"the combination")," of all these individual things ",(0,o.kt)("em",{parentName:"p"},"in lots of photos labeled")," \u2018Bouquet_Floral_Holding\u2019; and thus, that is the top result."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"images for concept performance",src:a(88812).Z,width:"1600",height:"858"})),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"images for concept performance",src:a(32378).Z,width:"1250",height:"832"}))))),(0,o.kt)("p",null,"One way to fix this is to ",(0,o.kt)("strong",{parentName:"p"},"narrow")," the training data for \u2018Bouquet_Floral_Holding\u2019 to images in which the bouquet is the focal point, rather than any instance of the bouquet being held. "),(0,o.kt)("p",null,"This way, the model can focus on the anchoring theme/object within the dataset more easily."),(0,o.kt)("h2",{id:"is-there-a-checklist-i-can-use-for-training-custom-models"},"Is there a checklist I can use for training custom models?"),(0,o.kt)("p",null,"Here is a checklist you can use to help you make the most out of training your own models. "),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null}),(0,o.kt)("th",{parentName:"tr",align:null}))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Are the images visually distinct?"))),(0,o.kt)("td",{parentName:"tr",align:null},"Ensure the images have visually noticeable qualities. They should not be too subtle for humans to pick up on, and they should also be able to be picked up through the noise of a photo. Also, look for whether or not those noticeable qualities are distinct enough to be repeatable across inputs.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Are the ideal/not ideal inputs defined?"))),(0,o.kt)("td",{parentName:"tr",align:null},"Create a visual dictionary of what each concept\u2019s training data will and will not be trained for. Determine the best resolution and image size for optimal data throughput. Remember to set aside evaluation data at the start of each project. A split of 80% training data to 20% evaluation data should be good to start.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Are the labels semantically clear?"))),(0,o.kt)("td",{parentName:"tr",align:null},"Make sure the labels for concepts reflect what the photo is of, not just what is in the photo.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Is the training data UGC optimized?"))),(0,o.kt)("td",{parentName:"tr",align:null},"You need to ensure the training and test data match the reality of the use case appertaining to user-generated content (UGC). Your evaluation test set should reflect this.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Do you have the assets ready?"))),(0,o.kt)("td",{parentName:"tr",align:null},"Have model versions and API keys on-hand for testing and for running scripts, if applicable.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("ul",null,(0,o.kt)("li",null,"Do you track labels?"))),(0,o.kt)("td",{parentName:"tr",align:null},"Keep track of the number of images labeled, either via JIRA or any docs platform.")))),(0,o.kt)("h2",{id:"what-is-ground-truth-and-how-do-we-use-it-to-dictate-model-building"},"What is \u201cground truth\u201d and how do we use it to dictate model building?"),(0,o.kt)("p",null,"Ground truth is the mutual understanding of a concept based solely on visual criteria. We work with clients to define ground truth early in the model building process in order to be sure that we are speaking the same language when it comes to choosing training data for a concept. "),(0,o.kt)("p",null,"We are asking not what the meaning of a concept is, but how a concept appears in the worldview of our models."),(0,o.kt)("p",null,"We will not be able to determine the accuracy of a model if we do not have ground truth. Once we know what a model ",(0,o.kt)("em",{parentName:"p"},"should")," be predicting, then we can move forward in determining the model\u2019s accuracy."),(0,o.kt)("h2",{id:"how-do-we-train-for-closed-set-and-open-set-recognition"},"How do we train for closed-set and open-set recognition?"),(0,o.kt)("p",null,"When we have a multi-class recognition model, there is no hard and fast \u201crule\u201d as to how one should build its training set, but how one should approach training depends on the use-case of your model."),(0,o.kt)("p",null,"In closed-set recognition, all concepts are known at training time. In open-set recognition, an incomplete knowledge of the world is present at the time of training your model, and unknown concepts can be submitted to the model during testing."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"closed-set and open-set recognition",src:a(13746).Z,width:"1451",height:"1048"}),"\n",(0,o.kt)("em",{parentName:"p"},"From Statistical Methods for Open Set Recognition ",(0,o.kt)("a",{parentName:"em",href:"https://www.wjscheirer.com/misc/openset/cvpr2016-open-set-part1.pdf"},"[1]"))),(0,o.kt)("p",null,"More often than not, open-set problems are found in nearly every case where visual recognition algorithms are used. "),(0,o.kt)("h2",{id:"what-is-the-roc-auc-score-and-how-does-it-relate-to-prediction-accuracy"},"What is the ROC AUC score, and how does it relate to prediction accuracy?"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"closed-set and open-set recognition",src:a(14329).Z,width:"1600",height:"772"}),"\n",(0,o.kt)("em",{parentName:"p"},"Above table is available in model evaluation page in the legacy Clarifai\u2019s Explorer UI")),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"ROC AUC")," (Concept Accuracy Score) is the concept\u2019s prediction performance score, defined by the area under the Receiver Operating Characteristic curve. This score gives us an idea of how well we have separated our different classes, or concepts. "),(0,o.kt)("p",null,"ROC AUC is generated by plotting the True Positive Rate (y-axis) against the False Positive Rate (x-axis) as you vary the threshold for assigning observations to a given class. The AUC, or ",(0,o.kt)("strong",{parentName:"p"},"A"),"rea ",(0,o.kt)("strong",{parentName:"p"},"U"),"nder the ",(0,o.kt)("strong",{parentName:"p"},"C"),"urve of these points, is (arguably) the best way to summarize a model\u2019s performance in a single number. "),(0,o.kt)("p",null,"You can think of AUC as representing the probability that a classifier will rank a randomly chosen positive observation higher than a randomly chosen negative observation, and thus it is a useful metric even for datasets with highly unbalanced classes. "),(0,o.kt)("p",null,"A score of 1 represents a perfect model; a score of .5 represents a model that would be no better than random guessing, and this wouldn\u2019t be suitable for predictions and should be re-trained. "),(0,o.kt)("p",null,"Note that the ROC AUC is ",(0,o.kt)("em",{parentName:"p"},"not")," dependent on the prediction threshold."),(0,o.kt)("h2",{id:"how-do-we-read-a-concept-by-concept-matrix"},"How do we read a concept-by-concept matrix?"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"concept-by-concept matrix",src:a(34264).Z,width:"1600",height:"538"}),"\n",(0,o.kt)("em",{parentName:"p"},"Above table is available in model evaluation page in the legacy Clarifai\u2019s Explorer UI")),(0,o.kt)("p",null,"A concept-by-concept matrix is a graphic flattening of data to show what has been labeled for a concept. This tool is another way of visualizing the performance of a model. "),(0,o.kt)("p",null,"It allows us to review where we see true positives, or correctly predicted inputs (the diagonal row). Simply put, this is an excellent tool for telling us where our model gets things right or wrong. "),(0,o.kt)("p",null,"Each row represents the subset of the test set that was actually labeled as a concept, e.g., \u201cdog.\u201d As you go across the row, each cell shows the number of times those images were predicted as each concept, noted by the column name."),(0,o.kt)("h2",{id:"along-with-auc-what-other-insights-can-a-confusion-matrix-provide"},"Along with AUC, what other insights can a confusion matrix provide?"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Accuracy"),"\u2014Overall, how often is the model correct?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Misclassification Rate"),"\u2014Overall, how often is it wrong?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"True Positive Rate"),"\u2014When it's actually yes, how often does it predict yes?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"False Positive Rate"),"\u2014When it's actually no, how often does it predict yes?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Specificity"),"\u2014When it's actually no, how often does it predict no?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Precision"),"\u2014When it predicts yes, how often is it correct?"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Prevalence"),"\u2014How often does the yes condition actually occur in our sample?")),(0,o.kt)("p",null,"The diagonal cells represent True Positives, i.e., correctly predicted inputs. You\u2019d want this number to be as close to the Total Labeled as possible."),(0,o.kt)("p",null,"Depending on how your model was trained, the off-diagonal cells could include both correct and incorrect predictions. In a non-mutually exclusive concepts environment, you can label an image with more than 1 concept."),(0,o.kt)("p",null,"For example, an image labeled as both \u201chamburger\u201d and \u201csandwich\u201d would be counted in both the \u201chamburger\u201d row and the \u201csandwich\u201d row. If the model correctly predicts this image to be both \u201chamburger\u201d and \u201csandwich,\u201d then this input will be counted in both on and off-diagonal cells."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"concept-by-concept matrix",src:a(34264).Z,width:"1600",height:"538"}),"\n",(0,o.kt)("em",{parentName:"p"},"Above table is available in model evaluation page in the legacy Clarifai\u2019s Explorer UI")),(0,o.kt)("p",null,"This is a sample confusion matrix for a model. The Y-axis ",(0,o.kt)("inlineCode",{parentName:"p"},"Actual Concepts")," are plotted against the X-axis ",(0,o.kt)("inlineCode",{parentName:"p"},"Predicted Concepts.")," The cells display average prediction probability for a certain concept, and for a group of images that were labeled as a certain concept. "),(0,o.kt)("p",null,"The diagonal cells are the average probability for true positives, and any cells off the horizontal cells contain the average probability for non-true positives. From this confusion matrix, we can see that each concept is distinct from one another, with a few areas of overlap, or clustering."),(0,o.kt)("p",null,"Concepts that co-occur, or are similar, may appear as a cluster on the matrix. "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"concepts co-occurence",src:a(6425).Z,width:"630",height:"616"})),(0,o.kt)("p",null,"In the above sample matrix for a food model trained to predict the cooking preparation for foods, we see a cluster around \u2018Gratin\u2019 and \u2018Baked\u2019. Without the context of what these concepts mean or how the training data appears, we can assume that the training data looks very similar, and it is (\u2018Gratin\u2019 is a variant of baked preparation, only with cheese)."),(0,o.kt)("p",null,"And so, clusters aren\u2019t necessarily a bad thing; and sometimes they are absolutely correct if the subject matter is naturally similar.  "),(0,o.kt)("p",null,"At Clarifai, we can work with you to determine if the cluster or area of confusion is appropriate for the final model. "),(0,o.kt)("p",null,"Here is an example of a noisy matrix:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Hair Volume - Version I"),(0,o.kt)("th",{parentName:"tr",align:null},"Hair Volume - Version II"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"hair volume 1",src:a(49712).Z,width:"490",height:"402"})),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("img",{alt:"hair volume 2",src:a(77641).Z,width:"636",height:"552"}))))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"1-2 concept model (left)"),": Hair Volume is graded as it appears from root to tip, either voluminous, or not voluminous."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"1-4 concept model (right)"),": Hair Volume is tiered depending on where it exists from the root, ends of the hair, and hair length. Level 4 is the most distinct because it is dependent on the shortest hair length.")),(0,o.kt)("p",null,"The matrix on the right is an example of a noisy matrix, compared to the binary model on the left, which has a more clearly defined diagonal line. "),(0,o.kt)("p",null,"Concepts trained with data that is too similar, too subtle to differentiate, or labeled across different concepts, will muddle the distinction between concepts, and will not form a clean diagonal line in a confusion matrix. "),(0,o.kt)("p",null,"In this case, the model on the left would be considered the ideal concept distinction."),(0,o.kt)("h2",{id:"how-can-i-improve-a-model-by-drilling-down-to-problematic-cells-in-a-confusion-matrix"},"How can I improve a model by drilling down to \u201cproblematic cells\u201d in a confusion matrix?"),(0,o.kt)("p",null," ",(0,o.kt)("img",{alt:"problematic cells in a confusion matrix",src:a(16900).Z,width:"1600",height:"978"})),(0,o.kt)("h2",{id:"what-is-the-importance-of-recall-and-precision-rate"},"What is the importance of recall and precision rate?"),(0,o.kt)("p",null,"Recall rate refers to the proportion of the images labeled as the concept that were predicted as the concept. It is calculated as True Positives divided by Total Labeled. Also known as \u201csensitivity\u201d or \u201ctrue positive rate.\u201d"),(0,o.kt)("p",null,"Precision rate refers to the proportion of the images predicted as a concept that had been actually labeled as the concept. It is calculated as True Positives divided by Total Predicted. Also known as \u201cpositive predictive value.\u201d"),(0,o.kt)("p",null,"You can think of precision and recall in the context of what we want to calibrate our model towards. Precision and recall are inversely correlated; so, ultimately the ratio of false positives to false negatives is up to the client according to their goal."),(0,o.kt)("p",null,"We\u2019re asking one of the following of our model:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"That the guesses are correct, while missing some concepts (high precision);")),(0,o.kt)("p",null,"Or,"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"That most things are considered to be predicted as a concept, while having some wrong predictions (high recall).")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example:"),"  "),(0,o.kt)("p",null,"Precision = tp\xf7(tp+fp)"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"I guess for X, and my guess is correct, although I may miss another X.")),(0,o.kt)("p",null,"Or,"),(0,o.kt)("p",null,"Recall = tp \xf7 (tp+fn)"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"I guess all the X as X, but occasionally predict other subjects that are not X as X.")),(0,o.kt)("h2",{id:"how-do-we-choose-a-prediction-threshold"},"How do we choose a prediction threshold?"),(0,o.kt)("p",null,"A threshold is the \u201csweet spot\u201d numerical score that is dependent on the objective of your prediction for recall and/or precision. In practice, there are multiple ways to define \u201caccuracy\u201d when it comes to machine learning, and the threshold is the number we use to gauge our preferences."),(0,o.kt)("p",null,"You might be wondering how you should set your classification threshold, once you are ready to use it to predict out-of-sample data. This is more of a business decision, in that you have to decide whether you would rather minimize your ",(0,o.kt)("a",{parentName:"p",href:"#along-with-auc-what-other-insights-can-a-confusion-matrix-provide"},"false positive rate or maximize your true positive rate"),". "),(0,o.kt)("p",null,"If our model is used to predict concepts that lead to a high-stakes decision, like a diagnosis of a disease or moderation for safety, we might consider a few false positives as forgivable (better to be safe than sorry!). In this case, we might want ",(0,o.kt)("strong",{parentName:"p"},"high precision"),"."),(0,o.kt)("p",null,"If our model is used to predict concepts that lead to a suggestion or flexible outcome, we might want ",(0,o.kt)("strong",{parentName:"p"},"high recall")," so that the model can allow for exploration. "),(0,o.kt)("p",null,"In either scenario, we will want to ensure our model is trained and tested with data that best reflects its use case."),(0,o.kt)("p",null,"Once we have determined the goal of our model (high precision or high recall), we can use test data that our model has never seen before to evaluate how well our model predicts according to the standards we have set."),(0,o.kt)("h2",{id:"once-a-model-is-trained-and-evaluated-how-do-we-determine-its-accuracy"},"Once a model is trained and evaluated, how do we determine its accuracy?"),(0,o.kt)("p",null,"The goal of any model is to get it to see the world as you see it."),(0,o.kt)("p",null,"In ",(0,o.kt)("strong",{parentName:"p"},"multi-class classification,")," accuracy is determined by the number of correct predictions divided by the total number of examples."),(0,o.kt)("p",null,"In ",(0,o.kt)("strong",{parentName:"p"},"binary classification,")," or for mutually exclusive classes, accuracy is determined by the number of true positives added to the number of true negatives, divided by the total number of examples."),(0,o.kt)("p",null,"Once we have established the goal we are working towards with the ground truth, we begin to assess your model\u2019s prediction returns. This is a completely subjective question, and most clients simply want to know that their models will perform to their standards once it is in the real world."),(0,o.kt)("p",null,"We begin by running a test set of images through the model and reading their precision and recall scores. The test set of images should be:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"a) inputs that the model has not been trained with, and;"),(0,o.kt)("li",{parentName:"ul"},"b) be the same kind of data we would expect to see in the model\u2019s particular use case. ")),(0,o.kt)("p",null,"Once we have our precision or recall scores, we will compare these to the model\u2019s recall or precision thresholds for .5 and .8, respectively."))}h.isMDXComponent=!0},6425:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/co_occurence_gratin_baked-77d330cf84d4b548a6320caf171c37b4.png"},34264:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/concept_by_concept_matrix-5f01625104a02f76b58e833d8884b523.png"},88812:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/concept_performance_1-1f1148c4dbeaa8f74a0ba57a545a24b4.png"},32378:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/concept_performance_2-e78a66a986490cf6a8666bd2d40c91b7.png"},59116:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/framing_right_problem-1d609e37baa3209736bbb249f76def9d.png"},34990:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/framing_right_problem_concepts-df3760de68b38de5ea018833eb247c5b.png"},13746:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/negatives_and_positives-4eb0c6a1203142b6e14eeb3e4cb148a3.png"},49712:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/noisy_matrix_1-a29fa87e95a1b1f6a6b35f3b3b8c77e6.png"},77641:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/noisy_matrix_2-70a765488398ab02743f9cdc3e6317f2.png"},16900:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/problematic_cells-fb5341412905358b3fe6750fea6eb48b.png"},14329:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/roc_auc-f6eede4bf545536f93ce90b27acc6e70.png"},53560:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wedding_imagery-6ee7b5068f5a31187834c06182a98d5c.jpg"}}]);