"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[210],{85162:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),r=a(86010);const o={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(o.tabItem,i),hidden:a},t)}},74866:(e,t,a)=>{a.d(t,{Z:()=>w});var n=a(87462),r=a(67294),o=a(86010),i=a(12466),l=a(16550),s=a(91980),u=a(67392),c=a(50012);function d(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function p(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=t??d(a);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function h(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:a}=e;const n=(0,l.k6)(),o=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,s._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(n.location.search);t.set(o,e),n.replace({...n.location,search:t.toString()})}),[o,n])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,o=p(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:o}))),[s,u]=m({queryString:a,groupId:n}),[d,f]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,o]=(0,c.Nk)(a);return[n,(0,r.useCallback)((e=>{a&&o.set(e)}),[a,o])]}({groupId:n}),g=(()=>{const e=s??d;return h({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{g&&l(g)}),[g]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,o]),tabValues:o}}var g=a(72389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:a,selectedValue:l,selectValue:s,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),p=e=>{const t=e.currentTarget,a=c.indexOf(t),n=u[a].value;n!==l&&(d(t),s(n))},h=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":a},t)},u.map((e=>{let{value:t,label:a,attributes:i}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>c.push(e),onKeyDown:h,onClick:p},i,{className:(0,o.Z)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":l===t})}),a??t)})))}function y(e){let{lazy:t,children:a,selectedValue:n}=e;const o=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function v(e){const t=f(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",b.tabList)},r.createElement(k,(0,n.Z)({},e,t)),r.createElement(y,(0,n.Z)({},e,t)))}function w(e){const t=(0,g.Z)();return r.createElement(v,(0,n.Z)({key:String(t)},e))}},73877:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>k,contentTitle:()=>g,default:()=>T,frontMatter:()=>f,metadata:()=>b,toc:()=>y});var n=a(87462),r=(a(67294),a(3905)),o=a(74866),i=a(85162),l=a(90814);const s="# Import the RAG module from Clarifai for conversational AI tasks\nfrom clarifai.rag import RAG\n\n# Set the user ID for authentication\nUSER_ID = 'USER_ID'\n\n# Define the URL of the Mistral-7B language model\nLLM_URL = 'https://clarifai.com/mistralai/completion/models/mistral-7B-Instruct'\n\n# Define a template string for generating prompts during inference\nRAG_PROMPT_TEMPLATE = \"<s>[INST] Context information is below:\\n{data.hits}\\nGiven the context information and not prior knowledge, answer the query.\\nQuery: {data.text.raw}\\nAnswer:  [/INST]\"\n\n# Setup a RAG object with specified parameters such as user ID, model URL,\n# minimum score threshold, and prompt template\nrag_object = RAG.setup(user_id=USER_ID, llm_url=LLM_URL, min_score=0.5, max_results = 2, prompt_template=RAG_PROMPT_TEMPLATE)",u='FILE_PATH="RAG/data/Crawfords_Auto_Repair_Guide.txt"\nrag_object.upload(file_path=FILE_PATH,chunk_size= 1024) #parameters to split the document into chunks',c='# Initiating a conversation with the RAG (Retrieval Augmented Generation) model object (`rag_object_gpt`).\n# Sending a message containing the query "How to change brake fluid" to the model and awaiting a response.\nresult = rag_object.chat(messages=[{"role": "human", "content": "How to change brake fluid"}])\n\n# Extracting the content of the response from the result.\nanswer = result[0]["content"]\n\n# Printing out the response\nprint(answer)',d='result=rag_object.chat(messages=[{"role":"human", "content":"procedure after following the above steps"}])\n\nanswer=result[0]["content"]\n\nprint(answer)',p='2024-03-20 10:34:02 INFO     clarifai.client.input:                                                    input.py:674\n\n                             Inputs Uploaded                                                                       \n\n                             code: SUCCESS                                                                         \n\n                             description: "Ok"                                                                     \n\n                             details: "All inputs successfully added"                                              \n\n                             req_id: "848c5233f9d67f1904da10c33a214ff9"                                            \n\n                                                                                                                   \n\nINFO:clarifai.client.input:\n\nInputs Uploaded\n\ncode: SUCCESS\n\ndescription: "Ok"\n\ndetails: "All inputs successfully added"\n\nreq_id: "848c5233f9d67f1904da10c33a214ff9"',h="To change the brake fluid, you will need to follow these steps: \n\n \n\n1. Locate the brake fluid reservoir in your vehicle. It is usually a clear plastic container with MAX and MIN markings on it. \n\n \n\n2. Use a turkey baster or a brake fluid pump to remove the old brake fluid from the reservoir. Be careful not to spill any brake fluid on the car's paint as it can damage the finish. \n\n \n\n3. Once the old fluid is removed, clean the reservoir with a lint-free cloth to ensure there is no contamination. \n\n \n\n4. Refill the reservoir with new brake fluid that is recommended for your specific vehicle. Make sure to use the type of brake fluid specified in your owner's manual. \n\n \n\n5. Slowly pour the new brake fluid into the reservoir up to the MAX marking. Avoid overfilling. \n\n \n\n6. After filling the reservoir, you may need to bleed the brake system to remove any air bubbles. This process may vary depending on your vehicle, so it's best to consult your owner's manual or a professional mechanic for guidance. \n\n \n\n7. Once the brake fluid is changed and the system is bled, check for any leaks or issues before driving the vehicle. \n\n \n\nRemember, if you are not comfortable or experienced with changing brake fluid, it is recommended to have this task done by a professional mechanic. Brake fluid is a critical component of your vehicle's braking system, and proper maintenance is essential for your safety on the road. ",m=" After following the steps to drain, flush, and pressure test the cooling system as described in the text, the next procedure would be to check for any leaks in the cooling system. This can be done by inspecting the entire cooling system, including the radiator, hoses, water pump, and heater core, for any signs of leaks. If there is less pressure on the gauge after the pressure test, there is probably a leak. Additionally, the engine should be started and the temperature gauge should be monitored to ensure that the cooling system is functioning properly. If the engine overheats or the temperature gauge reads high, further diagnosis and repair may be necessary.",f={sidebar_position:9},g="Building RAG Applications",b={unversionedId:"python-sdk/rag",id:"python-sdk/rag",title:"Building RAG Applications",description:"Learn how to build a RAG application using  Clarifai Python SDK",source:"@site/docs/python-sdk/rag.md",sourceDirName:"python-sdk",slug:"/python-sdk/rag",permalink:"/python-sdk/rag",draft:!1,editUrl:"https://github.com/Clarifai/docs/blob/main/docs/python-sdk/rag.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Advance Search Operations",permalink:"/python-sdk/Search/Advance-Search"},next:{title:"SDK Notebook Examples",permalink:"/python-sdk/notebook-examples"}},k={},y=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initialising RAG",id:"initialising-rag",level:2},{value:"Dataset Upload",id:"dataset-upload",level:2},{value:"Chat",id:"chat",level:2}],v={toc:y},w="wrapper";function T(e){let{components:t,...a}=e;return(0,r.kt)(w,(0,n.Z)({},v,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"building-rag-applications"},"Building RAG Applications"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Learn how to build a RAG application using  Clarifai Python SDK")),(0,r.kt)("hr",null),(0,r.kt)("p",null,"In the realm of text generation, Retrieval Augmented Generation (RAG) steps up the game for Large Language Models (LLMs) by fusing information retrieval capabilities with text generation skills, tackling key drawbacks of LLMs. When presented with a query, RAG fetches relevant information from an external knowledge base, which increases precision and contextual appropriateness through the integration of this retrieved data into the input. The Clarifai Python SDK allows you to create RAG-based applications with ease by reducing the number of steps in the process."),(0,r.kt)("p",null,"Click ",(0,r.kt)("a",{parentName:"p",href:"https://www.clarifai.com/blog/what-is-rag-retrieval-augmented-generation"},"here")," to learn more about RAG."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Setting up the Clarifai Python SDK along with PAT. Refer to the installation and configuration with the PAT token ",(0,r.kt)("a",{parentName:"li",href:"https://docs.clarifai.com/python-sdk/sdk-overview/"},"here"),".")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Guide to get your ",(0,r.kt)("a",{parentName:"p",href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens"},"PAT"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Clone the Clarifai Examples repository to get the data files required for the building RAG.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"!git clone https://github.com/Clarifai/examples.git\n%cd /content/examples/\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"To run on a local system use: cd examples/ ")),(0,r.kt)("h2",{id:"initialising-rag"},"Initialising RAG"),(0,r.kt)("p",null,"The first part of creating a RAG-based application includes setting up the RAG object. Just by setting up the RAG object, Clarifai Python SDK will automatically create the app along with a prompter model and workflow containing the RAG prompter and the LLM Model."),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},s))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Image Output"),(0,r.kt)("img",{src:"/img/python-sdk/rag_init.png",width:"700",height:"700"})),(0,r.kt)("p",null,"Here we are opting for Mistral-7B-Instruct as the LLM Model. You can choose different LLM Models for the RAG agent from Clarifai Community ",(0,r.kt)("a",{parentName:"p",href:"https://clarifai.com/explore/models?filterData=%5B%7B%22field%22%3A%22use_cases%22%2C%22value%22%3A%5B%22llm%22%5D%7D%5D&page=1&perPage=24"},"Models"),". The Clarifai Python SDK also allows you to set parameters like min_score,max_results and prompt_template  for retrieving relevant data."),(0,r.kt)("h2",{id:"dataset-upload"},"Dataset Upload"),(0,r.kt)("p",null,"The next step involves uploading the dataset. In this example, we are using a Vehicle Repair Manual as data for the RAG. You can use the RAG object we created earlier for the data upload process. Now comes the perks of using Clarifai Python SDK. When you upload the data the Clarifai platform will automatically generate embeddings for the inputs and store them in the vector database which makes it ready for retrieval seconds after uploading data."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Supported formats for upload are Doc, PDF, Text, Folder Containing PDF, Doc and URL of PDF,Doc, Text files.")),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},u))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Output"),(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},p)),(0,r.kt)("h2",{id:"chat"},"Chat"),(0,r.kt)("p",null,"In the final step, we are going to perform information retrieval using RAG based on the data we provided."),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},c))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Output"),(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},h)),(0,r.kt)("p",null,"Now let's ask questions that are related to the answer we received before so that we can be sure the RAG has understood the context properly."),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},d))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Output"),(0,r.kt)(l.Z,{className:"language-python",mdxType:"CodeBlock"},m)))}T.isMDXComponent=!0}}]);