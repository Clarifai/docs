"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[9943],{12326:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/compute-12-46ab3e2366be232a08887c0977806e8f.png"},52750:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/compute-14-1-d46afae508334bb5fe6896103c279a90.png"},57381:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>m,contentTitle:()=>h,default:()=>g,frontMatter:()=>u,metadata:()=>o,toc:()=>y});const o=JSON.parse('{"id":"compute/deployments/deploy-model","title":"Deploy a Model","description":"Deploy a model into your created cluster and nodepool","source":"@site/docs/compute/deployments/deploy-model.md","sourceDirName":"compute/deployments","slug":"/compute/deployments/deploy-model","permalink":"/compute/deployments/deploy-model","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"description":"Deploy a model into your created cluster and nodepool","sidebar_position":2,"toc_max_heading_level":4},"sidebar":"tutorialSidebar","previous":{"title":"Create Clusters and Nodepools","permalink":"/compute/deployments/clusters-nodepools"},"next":{"title":"Manage Your Compute","permalink":"/compute/deployments/manage-compute"}}');var l=t(74848),a=t(28453),r=t(65537),i=t(79329),s=t(58069);const d='from clarifai.client.nodepool import Nodepool\nimport os\n\n# Set the PAT key\nos.environ["CLARIFAI_PAT"] = "YOUR_PAT_HERE" \n\n# Initialize the Nodepool instance\nnodepool = Nodepool(\n    user_id="YOUR_USER_ID_HERE",            \n    nodepool_id="test-nodepool",   \n    base_url="https://api.clarifai.com"            \n)\n\n# Create a new deployment\ndeployment = nodepool.create_deployment(\n    deployment_id="test-deployment", \n    config_filepath="./configs/deployment_config.yaml"\n)',c="clarifai deployment create --config <deployment-config-filepath>",p='from clarifai.client.deployment import Deployment\n\n# Initialize the deployment\ndeployment = Deployment(\n    user_id="YOUR_USER_ID_HERE", \n    deployment_id="test-deployment",\n    base_url="https://api.clarifai.com"\n)\n',u={description:"Deploy a model into your created cluster and nodepool",sidebar_position:2,toc_max_heading_level:4},h="Deploy a Model",m={},y=[{value:"<strong>Via the UI</strong>",id:"via-the-ui",level:2},{value:"Step 1: Start Creating a Deployment",id:"step-1-start-creating-a-deployment",level:3},{value:"Step 2: Select a Model",id:"step-2-select-a-model",level:3},{value:"Step 3: Select Cluster and Nodepool",id:"step-3-select-cluster-and-nodepool",level:3},{value:"Step 4: Provide Deployment ID",id:"step-4-provide-deployment-id",level:3},{value:"Step 5: Configure Advanced Settings",id:"step-5-configure-advanced-settings",level:3},{value:"Step 6: Finalize and Create the Deployment",id:"step-6-finalize-and-create-the-deployment",level:3},{value:"<strong>Via the API</strong>",id:"via-the-api",level:2},{value:"Create a Deployment",id:"create-a-deployment",level:3}];function f(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"deploy-a-model",children:"Deploy a Model"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Deploy a model into your created cluster and nodepool"})}),"\n",(0,l.jsx)("hr",{}),"\n",(0,l.jsx)(n.p,{children:"Clarifai\u2019s Compute Orchestration provides efficient capabilities for you to deploy any model on any compute infrastructure, at any scale."}),"\n",(0,l.jsx)(n.p,{children:"You can configure your compute environment and deploy your models into nodepools with your preferred settings, optimizing for both cost and scalability."}),"\n",(0,l.jsx)(n.p,{children:"With model deployment, you can quickly take a trained model and set it up for inference."}),"\n",(0,l.jsxs)(n.admonition,{type:"tip",children:[(0,l.jsx)(n.mdxAdmonitionTitle,{}),(0,l.jsxs)(n.p,{children:["Learn how deployment works when making a prediction using our Compute Orchestration capabilities ",(0,l.jsx)(n.a,{href:"https://docs.clarifai.com/compute/models/inference/",children:"here"}),"."]})]}),"\n","\n","\n",(0,l.jsx)(n.h2,{id:"via-the-ui",children:(0,l.jsx)(n.strong,{children:"Via the UI"})}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsx)(n.p,{children:"Each model or workflow can only have one deployment per nodepool."})}),"\n",(0,l.jsx)(n.h3,{id:"step-1-start-creating-a-deployment",children:"Step 1: Start Creating a Deployment"}),"\n",(0,l.jsxs)(n.p,{children:["To create a deployment, navigate to the model\u2019s page and click the ",(0,l.jsx)(n.strong,{children:"Deploy Model"})," button."]}),"\n",(0,l.jsxs)(n.p,{children:["You can also open the ",(0,l.jsx)(n.strong,{children:"Deployments"})," tab to check if the model is already running on any compute environments."]}),"\n",(0,l.jsx)(n.p,{children:"This tab displays the compute requirements needed for successfully deploying the model, allowing you to choose a nodepool that meets those requirements."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:" ",src:t(12326).A+"",width:"1798",height:"904"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsxs)(n.em,{children:["Alternatively, to create a deployment, go to the specific cluster or nodepool where you want the deployment to run, then click the ",(0,l.jsx)(n.strong,{children:"Deploy Model"})," button on that page."]})}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:(0,l.jsx)(n.img,{alt:" ",src:t(96093).A+"",width:"1802",height:"845"})})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"step-2-select-a-model",children:"Step 2: Select a Model"}),"\n",(0,l.jsx)(n.p,{children:"You\u2019ll be redirected to a page where you can configure the compute settings for your deployment."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:" ",src:t(81071).A+"",width:"1894",height:"890"})}),"\n",(0,l.jsx)(n.p,{children:"If you haven\u2019t already selected a trained model, you can do so here. By default, the latest version of the model will be used, unless you switch the version toggle off to manually select a different version."}),"\n",(0,l.jsx)(n.p,{children:"The model\u2019s compute requirements will also be displayed, helping you select a compatible cluster and nodepool that meet those specifications."}),"\n",(0,l.jsx)(n.h3,{id:"step-3-select-cluster-and-nodepool",children:"Step 3: Select Cluster and Nodepool"}),"\n",(0,l.jsx)(n.p,{children:"Choose an existing cluster and nodepool \u2014 or create new ones \u2014 based on your model\u2019s compute requirements and performance goals."}),"\n",(0,l.jsx)(n.p,{children:"Once selected, the details of the chosen cluster and nodepool will be displayed for your review."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:" ",src:t(85200).A+"",width:"1911",height:"910"})}),"\n",(0,l.jsx)(n.h3,{id:"step-4-provide-deployment-id",children:"Step 4: Provide Deployment ID"}),"\n",(0,l.jsx)(n.p,{children:"Provide a deployment ID to uniquely identify your deployment."}),"\n",(0,l.jsx)(n.p,{children:"You can also add an optional description to provide additional context and make it easier to recognize later."}),"\n",(0,l.jsx)(n.h3,{id:"step-5-configure-advanced-settings",children:"Step 5: Configure Advanced Settings"}),"\n",(0,l.jsx)(n.p,{children:"You can also configure advanced deployment settings if needed. If you choose not to, the default values will be applied automatically."}),"\n",(0,l.jsx)("a",{id:"model-replica"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Model Replicas"})," \u2014 This specifies the minimum and maximum range of model replicas to deploy, adjusting based on your performance needs and anticipated workload. Adding replicas enables horizontal scaling, where the workload is distributed across several instances of the model rather than relying on a single one. However, increasing them consumes more resources and may lead to higher costs. Each node in your nodepool can host multiple replicas, depending on model size and available resources."]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{title:"node autoscaling range",type:"tip",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"/compute/deployments/clusters-nodepools#node-range",children:"Click here"})," to find out how to set up node autoscaling ranges to automatically adjust your infrastructure based on traffic demand."]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Scale Up Delay"})," \u2014 This sets the waiting period (in seconds) before adding resources in response to rising demand."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Scale Down Delay"})," \u2014 This sets the waiting period (in seconds) before reducing resources after a demand decrease. Note that your nodepool will only scale down to the minimum number of replica(s) configured."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Scale To Zero Delay"})," \u2014 This sets the idle time (in seconds) before scaling down to zero replicas after inactivity."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Traffic History Timeframe"})," \u2014 This defines the traffic history period (in seconds) that your deployment will review before making scaling decisions."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Disable Nodepool Packing"})," \u2014 Enabling this option restricts deployments to a single model replica per node. While this can be useful for specific performance needs, it may lead to underutilized nodes and increased costs due to reduced resource efficiency."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"step-6-finalize-and-create-the-deployment",children:"Step 6: Finalize and Create the Deployment"}),"\n",(0,l.jsxs)(n.p,{children:["After completing the setup, click the ",(0,l.jsx)(n.strong,{children:"Deploy Model"})," button to create the deployment. You\u2019ll be redirected to the nodepool page, where your deployed model will be listed."]}),"\n",(0,l.jsxs)(n.p,{children:["You can also find the deployment listed in the ",(0,l.jsx)(n.strong,{children:"Deployments"})," tab within the model's page. From there, you can select it to run ",(0,l.jsx)(n.a,{href:"https://docs.clarifai.com/compute/models/model-inference",children:"inferences"}),"."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:" ",src:t(52750).A+"",width:"1770",height:"878"})}),"\n",(0,l.jsx)(n.h2,{id:"via-the-api",children:(0,l.jsx)(n.strong,{children:"Via the API"})}),"\n",(0,l.jsx)(n.h3,{id:"create-a-deployment",children:"Create a Deployment"}),"\n",(0,l.jsxs)(n.p,{children:["To deploy a model within a nodepool you've created, provide the ",(0,l.jsx)(n.code,{children:"deployment_id"})," and ",(0,l.jsx)(n.code,{children:"config_filepath"})," parameters to the ",(0,l.jsx)(n.code,{children:"create_deployment"})," method of the ",(0,l.jsx)(n.code,{children:"Nodepool"})," class."]}),"\n",(0,l.jsxs)(n.p,{children:["You can learn how to create the ",(0,l.jsx)(n.code,{children:"deployment_config.yaml"})," file, which contains the deployment configuration details, ",(0,l.jsx)(n.a,{href:"/compute/deployments/clusters-nodepools#set-up-project-directory",children:"here"}),"."]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsx)(n.p,{children:"Each model or workflow can only have one deployment per nodepool."})}),"\n",(0,l.jsxs)(r.A,{groupId:"code",children:[(0,l.jsx)(i.A,{value:"python",label:"Python",children:(0,l.jsx)(s.A,{className:"language-python",children:d})}),(0,l.jsx)(i.A,{value:"bash",label:"CLI",children:(0,l.jsx)(s.A,{className:"language-yaml",children:c})})]}),"\n",(0,l.jsxs)(n.p,{children:["After creating it, initialize the ",(0,l.jsx)(n.code,{children:"Deployment"})," class by providing the ",(0,l.jsx)(n.code,{children:"user_id"})," and ",(0,l.jsx)(n.code,{children:"deployment_id"})," parameters."]}),"\n",(0,l.jsx)(r.A,{groupId:"code",children:(0,l.jsx)(i.A,{value:"python",label:"Python",children:(0,l.jsx)(s.A,{className:"language-python",children:p})})})]})}function g(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(f,{...e})}):f(e)}},65537:(e,n,t)=>{t.d(n,{A:()=>w});var o=t(96540),l=t(18215),a=t(65627),r=t(56347),i=t(50372),s=t(30604),d=t(11861),c=t(78749);function p(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,o.useMemo)((()=>{const e=n??function(e){return p(e).map((e=>{let{props:{value:n,label:t,attributes:o,default:l}}=e;return{value:n,label:t,attributes:o,default:l}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const l=(0,r.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,s.aZ)(a),(0,o.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(l.location.search);n.set(a,e),l.replace({...l.location,search:n.toString()})}),[a,l])]}function y(e){const{defaultValue:n,queryString:t=!1,groupId:l}=e,a=u(e),[r,s]=(0,o.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const o=t.find((e=>e.default))??t[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:n,tabValues:a}))),[d,p]=m({queryString:t,groupId:l}),[y,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[l,a]=(0,c.Dv)(t);return[l,(0,o.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:l}),g=(()=>{const e=d??y;return h({value:e,tabValues:a})?e:null})();(0,i.A)((()=>{g&&s(g)}),[g]);return{selectedValue:r,selectValue:(0,o.useCallback)((e=>{if(!h({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);s(e),p(e),f(e)}),[p,f,a]),tabValues:a}}var f=t(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function b(e){let{className:n,block:t,selectedValue:o,selectValue:r,tabValues:i}=e;const s=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),c=e=>{const n=e.currentTarget,t=s.indexOf(n),l=i[t].value;l!==o&&(d(n),r(l))},p=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=s.indexOf(e.currentTarget)+1;n=s[t]??s[0];break}case"ArrowLeft":{const t=s.indexOf(e.currentTarget)-1;n=s[t]??s[s.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:o===n?0:-1,"aria-selected":o===n,ref:e=>{s.push(e)},onKeyDown:p,onClick:c,...a,className:(0,l.A)("tabs__item",g.tabItem,a?.className,{"tabs__item--active":o===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:a}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===a));return e?(0,o.cloneElement)(e,{className:(0,l.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function v(e){const n=y(e);return(0,x.jsxs)("div",{className:(0,l.A)("tabs-container",g.tabList),children:[(0,x.jsx)(b,{...n,...e}),(0,x.jsx)(j,{...n,...e})]})}function w(e){const n=(0,f.A)();return(0,x.jsx)(v,{...e,children:p(e.children)},String(n))}},79329:(e,n,t)=>{t.d(n,{A:()=>r});t(96540);var o=t(18215);const l={tabItem:"tabItem_Ymn6"};var a=t(74848);function r(e){let{children:n,hidden:t,className:r}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,o.A)(l.tabItem,r),hidden:t,children:n})}},81071:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/compute-13-88bcaa6fcf19b87038cf7e02525700ee.png"},85200:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/compute-14-6ef2b7d85462cbf85f52d1969ab3d75b.png"},96093:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/compute-11-d9f9940513d5ab7aa311f91b202c2fbe.png"}}]);