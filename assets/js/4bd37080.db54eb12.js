"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[9943],{3588:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>m,contentTitle:()=>p,default:()=>g,frontMatter:()=>u,metadata:()=>h,toc:()=>y});var t=o(74848),l=o(28453),r=o(11470),a=o(19365),i=o(21432);const s='from clarifai.client.nodepool import Nodepool\nimport os\n\n# Set the PAT key\nos.environ["CLARIFAI_PAT"] = "YOUR_PAT_HERE" \n\n# Initialize the Nodepool instance\nnodepool = Nodepool(\n    user_id="YOUR_USER_ID_HERE",            \n    nodepool_id="test-nodepool",   \n    base_url="https://api.clarifai.com"            \n)\n\n# Create a new deployment\ndeployment = nodepool.create_deployment(\n    deployment_id="test-deployment", \n    config_filepath="./configs/deployment_config.yaml"\n)',d="clarifai deployment create --config <deployment-config-filepath>",c='from clarifai.client.deployment import Deployment\n\n# Initialize the deployment\ndeployment = Deployment(\n    user_id="YOUR_USER_ID_HERE", \n    deployment_id="test-deployment",\n    base_url="https://api.clarifai.com"\n)\n',u={description:"Deploy a model into your created cluster and nodepool",sidebar_position:2,toc_max_heading_level:4},p="Deploy a Model",h={id:"compute/deployments/deploy-model",title:"Deploy a Model",description:"Deploy a model into your created cluster and nodepool",source:"@site/docs/compute/deployments/deploy-model.md",sourceDirName:"compute/deployments",slug:"/compute/deployments/deploy-model",permalink:"/compute/deployments/deploy-model",draft:!1,unlisted:!1,editUrl:"https://github.com/Clarifai/docs/blob/main/docs/compute/deployments/deploy-model.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{description:"Deploy a model into your created cluster and nodepool",sidebar_position:2,toc_max_heading_level:4},sidebar:"tutorialSidebar",previous:{title:"Create Clusters and Nodepools",permalink:"/compute/deployments/clusters-nodepools"},next:{title:"Manage Your Compute",permalink:"/compute/deployments/manage-compute"}},m={},y=[{value:"<strong>Via the API</strong>",id:"via-the-api",level:2},{value:"Create a Deployment",id:"create-a-deployment",level:3},{value:"<strong>Via the UI</strong>",id:"via-the-ui",level:2},{value:"Create a Deployment",id:"create-a-deployment-1",level:3}];function f(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"deploy-a-model",children:"Deploy a Model"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Deploy a model into your created cluster and nodepool"})}),"\n",(0,t.jsx)("hr",{}),"\n",(0,t.jsx)(n.p,{children:"Clarifai\u2019s Compute Orchestration provides efficient capabilities for you to deploy any model on any compute infrastructure, at any scale."}),"\n",(0,t.jsx)(n.p,{children:"These platform capabilities bring the convenience of serverless autoscaling to any compute, regardless of where it\u2019s deployed and what hardware it\u2019s running on, and scale automatically to meet workload demands."}),"\n",(0,t.jsx)(n.p,{children:"Compute Orchestration allows you to upload a model, configure your SaaS or self-managed compute, and then deploy your model into your nodepools with your preferred settings cost-efficiently and scalably."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["Learn how to make your first deployment quickly on the UI using a pre-configured cluster and nodepool ",(0,t.jsx)(n.a,{href:"https://docs.clarifai.com/getting-started/first-deployment",children:"here"}),"."]})}),"\n","\n","\n",(0,t.jsx)(n.h2,{id:"via-the-api",children:(0,t.jsx)(n.strong,{children:"Via the API"})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-deployment",children:"Create a Deployment"}),"\n",(0,t.jsxs)(n.p,{children:["To deploy a model within a nodepool you've created, provide the ",(0,t.jsx)(n.code,{children:"deployment_id"})," and ",(0,t.jsx)(n.code,{children:"config_filepath"})," parameters to the ",(0,t.jsx)(n.code,{children:"create_deployment"})," method of the ",(0,t.jsx)(n.code,{children:"Nodepool"})," class."]}),"\n",(0,t.jsxs)(n.p,{children:["You can learn how to create the ",(0,t.jsx)(n.code,{children:"deployment_config.yaml"})," file, which contains the deployment configuration details, ",(0,t.jsx)(n.a,{href:"/compute/deployments/clusters-nodepools#set-up-project-directory",children:"here"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Each model or workflow can only have one deployment per nodepool."})}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsx)(a.A,{value:"python",label:"Python",children:(0,t.jsx)(i.A,{className:"language-python",children:s})}),(0,t.jsx)(a.A,{value:"bash",label:"CLI",children:(0,t.jsx)(i.A,{className:"language-yaml",children:d})})]}),"\n",(0,t.jsxs)(n.p,{children:["After creating it, initialize the ",(0,t.jsx)(n.code,{children:"Deployment"})," class by providing the ",(0,t.jsx)(n.code,{children:"user_id"})," and ",(0,t.jsx)(n.code,{children:"deployment_id"})," parameters."]}),"\n",(0,t.jsx)(r.A,{children:(0,t.jsx)(a.A,{value:"python",label:"Python",children:(0,t.jsx)(i.A,{className:"language-python",children:c})})}),"\n",(0,t.jsx)(n.admonition,{title:"Model Inferencing",type:"tip",children:(0,t.jsxs)(n.p,{children:["Once your model is deployed, you can use it for ",(0,t.jsx)(n.a,{href:"https://docs.clarifai.com/compute/models/model-inference",children:"inferencing"})," by calling the appropriate prediction methods. Note that you need to specify the ",(0,t.jsx)(n.code,{children:"deployment_id"})," parameter for ensure proper routing and execution of your prediction call."]})}),"\n",(0,t.jsx)(n.h2,{id:"via-the-ui",children:(0,t.jsx)(n.strong,{children:"Via the UI"})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-deployment-1",children:"Create a Deployment"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Each model or workflow can only have one deployment per nodepool."})}),"\n",(0,t.jsxs)(n.p,{children:["To deploy a model, navigate to your cluster or nodepool and click the ",(0,t.jsx)(n.strong,{children:"Deploy model"})," button in the page."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:" ",src:o(96093).A+"",width:"1865",height:"851"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Alternatively, navigate to a model's page, go to the ",(0,t.jsx)(n.strong,{children:"Deployments"})," tab, and click the ",(0,t.jsx)(n.strong,{children:"Deploy model"})," or ",(0,t.jsx)(n.strong,{children:"Deploy this model"})," button."]})}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:" ",src:o(12326).A+"",width:"1800",height:"814"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You\u2019ll be redirected to a page where you can customize the compute configurations for deploying your model."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:" ",src:o(81071).A+"",width:"1588",height:"1308"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Deployment details"})," \u2014 Create a deployment ID and description that helps identify your model version and selected compute combination."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Model and version"})," \u2014 Select an already trained model and the version you want to deploy."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cluster"})," \u2014Select or create a cluster."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Nodepool"})," \u2014 Select or create a nodepool to deploy your model considering your performance goals. The details of the dedicated cluster and nodepool you\u2019ve selected will be displayed."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Advanced Settings"})," \u2014 Optionally, you can click the collapsible section to configure the following settings:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Model Replicas"})," \u2014 This specifies the minimum and maximum range of model replicas to deploy, adjusting based on your performance needs and anticipated workload. Adding replicas enables horizontal scaling, where the workload is distributed across several instances of the model rather than relying on a single one. However, increasing them consumes more resources and may lead to higher costs. Each node in your nodepool can host multiple replicas, depending on model size and available resources."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scale Up Delay"})," \u2014 This sets the waiting period (in seconds) before adding resources in response to rising demand."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scale Down Delay"})," \u2014 This sets the waiting period (in seconds) before reducing resources after a demand decrease. Note that your nodepool will only scale down to the minimum number of replica(s) configured."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Traffic History Timeframe"})," \u2014 This defines the traffic history period (in seconds) that your deployment will review before making scaling decisions."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scale To Zero Delay"})," \u2014 This sets the idle time (in seconds) before scaling down to zero replicas after inactivity."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["After completing the setup, click the ",(0,t.jsx)(n.strong,{children:"Deploy Model"})," button at the bottom of the page to create the deployment."]}),"\n",(0,t.jsx)(n.p,{children:"You\u2019ll then be redirected to the nodepool page, where your deployed model will be listed."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:" ",src:o(85200).A+"",width:"1914",height:"675"})}),"\n",(0,t.jsxs)(n.p,{children:["You can find the deployment listed in the ",(0,t.jsx)(n.strong,{children:"Deployment"})," dropdown menu in the model's playground, where you can select it for ",(0,t.jsx)(n.a,{href:"https://docs.clarifai.com/compute/models/model-inference",children:"inferencing"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:" ",src:o(52750).A+"",width:"1894",height:"767"})})]})}function g(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},19365:(e,n,o)=>{o.d(n,{A:()=>a});o(96540);var t=o(18215);const l={tabItem:"tabItem_Ymn6"};var r=o(74848);function a(e){let{children:n,hidden:o,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(l.tabItem,a),hidden:o,children:n})}},11470:(e,n,o)=>{o.d(n,{A:()=>w});var t=o(96540),l=o(18215),r=o(23104),a=o(56347),i=o(205),s=o(57485),d=o(31682),c=o(70679);function u(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:o}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:o,attributes:t,default:l}}=e;return{value:n,label:o,attributes:t,default:l}}))}(o);return function(e){const n=(0,d.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,o])}function h(e){let{value:n,tabValues:o}=e;return o.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:o}=e;const l=(0,a.W6)(),r=function(e){let{queryString:n=!1,groupId:o}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!o)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:n,groupId:o});return[(0,s.aZ)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(l.location.search);n.set(r,e),l.replace({...l.location,search:n.toString()})}),[r,l])]}function y(e){const{defaultValue:n,queryString:o=!1,groupId:l}=e,r=p(e),[a,s]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:o}=e;if(0===o.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:o}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${o.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=o.find((e=>e.default))??o[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r}))),[d,u]=m({queryString:o,groupId:l}),[y,f]=function(e){let{groupId:n}=e;const o=function(e){return e?`docusaurus.tab.${e}`:null}(n),[l,r]=(0,c.Dv)(o);return[l,(0,t.useCallback)((e=>{o&&r.set(e)}),[o,r])]}({groupId:l}),g=(()=>{const e=d??y;return h({value:e,tabValues:r})?e:null})();(0,i.A)((()=>{g&&s(g)}),[g]);return{selectedValue:a,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),f(e)}),[u,f,r]),tabValues:r}}var f=o(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=o(74848);function b(e){let{className:n,block:o,selectedValue:t,selectValue:a,tabValues:i}=e;const s=[],{blockElementScrollPositionUntilNextRender:d}=(0,r.a_)(),c=e=>{const n=e.currentTarget,o=s.indexOf(n),l=i[o].value;l!==t&&(d(n),a(l))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const o=s.indexOf(e.currentTarget)+1;n=s[o]??s[0];break}case"ArrowLeft":{const o=s.indexOf(e.currentTarget)-1;n=s[o]??s[s.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":o},n),children:i.map((e=>{let{value:n,label:o,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>s.push(e),onKeyDown:u,onClick:c,...r,className:(0,l.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":t===n}),children:o??n},n)}))})}function j(e){let{lazy:n,children:o,selectedValue:l}=e;const r=(Array.isArray(o)?o:[o]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===l));return e?(0,t.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==l})))})}function v(e){const n=y(e);return(0,x.jsxs)("div",{className:(0,l.A)("tabs-container",g.tabList),children:[(0,x.jsx)(b,{...n,...e}),(0,x.jsx)(j,{...n,...e})]})}function w(e){const n=(0,f.A)();return(0,x.jsx)(v,{...e,children:u(e.children)},String(n))}},96093:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/compute-11-83919aa4c0f3f4184bf8d98c431ab414.png"},12326:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/compute-12-189b8351016c1852edfbf40ad92adf77.png"},81071:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/compute-13-7a15756036968461bcfde2d9542968ab.png"},52750:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/compute-14-1-7aac7e7d51e9f84611097db230e2f61a.png"},85200:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/compute-14-a4a1567176f65e3722f08faa5b17c413.png"}}]);