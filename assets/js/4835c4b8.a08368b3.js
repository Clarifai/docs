"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[3132],{62378:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>d,default:()=>f,frontMatter:()=>p,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"resources/authentication/key","title":"App-Specific API Keys","description":"Authenticate access to resources within the scope defined by the key","source":"@site/docs/resources/authentication/key.md","sourceDirName":"resources/authentication","slug":"/resources/authentication/key","permalink":"/resources/authentication/key","draft":false,"unlisted":false,"editUrl":"https://github.com/Clarifai/docs/blob/main/docs/resources/authentication/key.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"description":"Authenticate access to resources within the scope defined by the key","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Personal Access Tokens","permalink":"/resources/authentication/pat"},"next":{"title":"Authorize","permalink":"/resources/authentication/authorize"}}');var s=n(74848),r=n(28453),o=n(65537),i=n(79329),c=n(58069);const l="##################################################################################################\n# FOR SECURE AUTHENTICATION, SET API KEY AS AN ENVIRONMENT VARIABLE\n#################################################################################################\n\n# The built-in Python os library provides functions to access and manipulate environment variables\nimport os\n\n# Python-dotenv reads key-value pairs from a .env file and can set them as environment variables\n# Install the library by running `pip install python-dotenv`\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\n# Set the `CLARIFAI_API_KEY` environment variable before running the code. For example, you can set it in an .env file as `export CLARIFAI_API_KEY=YOUR_API_KEY_HERE`\n# Your API Key can be found in the platform in your app's settings page\n\nKEY = os.getenv('CLARIFAI_API_KEY')\nif KEY is None:\n    raise ValueError(\"API Key is not set. Please set the CLARIFAI_API_KEY environment variable.\")\n\n################################################################################################\n# In this section, we set the  model details and the URL of the image we want as an input. \n# Change these strings to run your own example.\n################################################################################################\n\nMODEL_ID = 'YOUR_MODEL_ID_HERE'\n# This is optional. You can specify a model version or the empty string for the default\nMODEL_VERSION_ID = ''\nIMAGE_URL = 'https://samples.clarifai.com/metro-north.jpg'\n\n############################################################################\n# YOU DO NOT NEED TO CHANGE ANYTHING BELOW THIS LINE TO RUN THIS EXAMPLE\n############################################################################\n\nfrom clarifai_grpc.channel.clarifai_channel import ClarifaiChannel\nfrom clarifai_grpc.grpc.api import resources_pb2, service_pb2, service_pb2_grpc\nfrom clarifai_grpc.grpc.api.status import status_code_pb2\n\nchannel = ClarifaiChannel.get_grpc_channel()\nstub = service_pb2_grpc.V2Stub(channel)\n\nmetadata = (('authorization', 'Key ' + KEY),)\n\npost_model_outputs_response = stub.PostModelOutputs(\n    service_pb2.PostModelOutputsRequest(\n        model_id=MODEL_ID,\n        version_id=MODEL_VERSION_ID,  \n        inputs=[\n            resources_pb2.Input(\n                data=resources_pb2.Data(\n                    image=resources_pb2.Image(\n                        url=IMAGE_URL\n                    )\n                )\n            )\n        ]\n    ),\n    metadata=metadata\n)\nif post_model_outputs_response.status.code != status_code_pb2.SUCCESS:\n    print(post_model_outputs_response.status)\n    raise Exception(\"Post model outputs failed, status: \" + post_model_outputs_response.status.description)\n\n# Since we have one input, one output will exist here\noutput = post_model_outputs_response.outputs[0]\n\nprint(\"Predicted concepts:\")\nfor concept in output.data.concepts:\n    print(\"%s %.2f\" % (concept.name, concept.value))\n\n# Uncomment this line to print the full Response JSON\n#print(output)",u='curl -X POST "https://api.clarifai.com/v2/models/YOUR_MODEL_ID_HERE/versions/YOUR_MODEL_VERSION_HERE/outputs" \\\n    -H "Authorization: Key YOUR_API_KEY_HERE" \\\n    -H "Content-Type: application/json" \\\n    -d \'{\n      "inputs": [\n        {\n          "data": {\n            "image": {\n              "url": "https://samples.clarifai.com/metro-north.jpg"\n            }\n          }\n        }\n      ]\n    }\'\n   ',p={description:"Authenticate access to resources within the scope defined by the key",sidebar_position:2},d="App-Specific API Keys",h={},m=[{value:"How to Create API Keys on the Platform",id:"how-to-create-api-keys-on-the-platform",level:2},{value:"How to Create API Keys Programmatically",id:"how-to-create-api-keys-programmatically",level:2},{value:"How to Use an API Key Example",id:"how-to-use-an-api-key-example",level:2}];function y(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"app-specific-api-keys",children:"App-Specific API Keys"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Authenticate access to resources within the scope defined by the key"})}),"\n",(0,s.jsx)("hr",{}),"\n",(0,s.jsx)(t.p,{children:"App-specific API Keys are used to authorize access to your Clarifai applications. You can use an API Key to access the resources within the scope of the app defined by that key."}),"\n",(0,s.jsxs)(t.p,{children:["A key is automatically generated when you create a new application. You can also create a new one, as described ",(0,s.jsx)(t.a,{href:"#how-to-create-api-keys-on-the-platform",children:"below"}),"."]}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["Each API Key is associated with a specific user and a specific app. It ties in ",(0,s.jsx)(t.code,{children:"user_id"})," and ",(0,s.jsx)(t.code,{children:"app_id"}),", causing only resources in that app to be usable."]})}),"\n",(0,s.jsx)(t.p,{children:"When using an app-specific API Key to make a request, you do not need to specify either the user ID or the application ID, as they are already part of the key."}),"\n",(0,s.jsx)(t.p,{children:"An API Key allows you to have fine-grained control over the data exposed through your app. You can control the scope of your key through a simple checkbox interface displayed when you create a new key or edit a key."}),"\n",(0,s.jsx)(t.admonition,{title:"API Key Versus PAT",type:"caution",children:(0,s.jsxs)(t.p,{children:["You cannot use an API Key to access models, model versions, workflows, or other resources that are not part of the app that the key is associated with. You need a ",(0,s.jsx)(t.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"PAT"})," to do so. For example, to access any of Clarifai's resources, you need to use a PAT while specifying Clarifai's ",(0,s.jsx)(t.code,{children:"user_id"})," and the ",(0,s.jsx)(t.code,{children:"app_id"})," to which the resource belongs."]})}),"\n",(0,s.jsx)(t.h2,{id:"how-to-create-api-keys-on-the-platform",children:"How to Create API Keys on the Platform"}),"\n",(0,s.jsxs)(t.p,{children:["Navigate to your application's individual page and select the ",(0,s.jsx)(t.strong,{children:"Settings"})," option on the collapsible left sidebar."]}),"\n",(0,s.jsxs)(t.p,{children:["You'll be redirected to the ",(0,s.jsx)(t.strong,{children:"App Settings"})," page."]}),"\n",(0,s.jsxs)(t.p,{children:["Within the ",(0,s.jsx)(t.strong,{children:"API Keys"})," section, click the ",(0,s.jsx)(t.strong,{children:"Create API Key"})," button."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"App settings create key",src:n(66182).A+"",width:"1867",height:"884"})}),"\n",(0,s.jsxs)(t.p,{children:["Then, use the form that pops up to generate a new key for your application \u2014 provide a short description, select the scopes, and click the ",(0,s.jsx)(t.strong,{children:"Confirm"})," button."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"App key create form",src:n(67145).A+"",width:"1889",height:"869"})}),"\n",(0,s.jsxs)(t.p,{children:["The new key will be listed in the ",(0,s.jsx)(t.strong,{children:"API Keys"})," section, where you can copy it to the clipboard, edit it, or delete it."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"copy, edit, delete api key",src:n(84681).A+"",width:"1892",height:"881"})}),"\n",(0,s.jsx)(t.h2,{id:"how-to-create-api-keys-programmatically",children:"How to Create API Keys Programmatically"}),"\n",(0,s.jsx)(t.p,{children:"For enterprise users, it is also possible to generate keys programmatically."}),"\n",(0,s.jsx)(t.p,{children:"If you are managing the work of multiple users, who's data, models, and concepts that need to be segregated, we recommend you create keys this way. This ensures that each individual user only has access to their own private resources."}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["You need to use a ",(0,s.jsx)(t.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"Personal Access Token (PAT)"})," to create an API Key."]})}),"\n","\n","\n",(0,s.jsx)(o.A,{children:(0,s.jsx)(i.A,{value:"cURL",label:"cURL",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'curl --location --request POST "https://api.clarifai.com/v2/users/YOUR_USER_ID_HERE/keys" \\\n--header "Content-Type: application/json" \\\n--header "Authorization: Key YOUR_PAT_HERE" \\\n--data-raw \'{\n    "keys": [\n        {\n            "description": "All permissions",\n            "scopes": [\n                "All"\n            ],\n            "apps": [\n                {\n                    "id": "YOUR_APP_ID_HERE",\n                    "user_id": "YOUR_USER_ID_HERE"\n                }\n            ]\n        }\n    ]\n}\'\n'})})})}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"API Keys do not expire. In case your key gets compromised, you should delete it, and create a new one with the same scopes."}),"\n",(0,s.jsxs)(t.li,{children:["We recommend that you do ",(0,s.jsx)(t.strong,{children:"not"})," share your API Key with other users."]}),"\n"]})}),"\n",(0,s.jsx)(t.h2,{id:"how-to-use-an-api-key-example",children:"How to Use an API Key Example"}),"\n",(0,s.jsx)(t.p,{children:"Here is an example of how to use an API Key to make a prediction request from your own model."}),"\n",(0,s.jsxs)(t.p,{children:["Note that your ",(0,s.jsx)(t.code,{children:"user_id"})," and ",(0,s.jsx)(t.code,{children:"app_id"})," are already tied to the key, so no need to specify them."]}),"\n",(0,s.jsx)(t.admonition,{title:"Set API Key as an Environment Variable",type:"tip",children:(0,s.jsx)(t.p,{children:"It's a good practice to load your API Key from an environment variable. Keeping your key in a secrets manager, and not in the source code, improves its security and management."})}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(i.A,{value:"python",label:"Python",children:(0,s.jsx)(c.A,{className:"language-python",children:l})}),(0,s.jsx)(i.A,{value:"curl",label:"cURL",children:(0,s.jsx)(c.A,{className:"language-bash",children:u})})]})]})}function f(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(y,{...e})}):y(e)}},65537:(e,t,n)=>{n.d(t,{A:()=>v});var a=n(96540),s=n(18215),r=n(65627),o=n(56347),i=n(50372),c=n(30604),l=n(11861),u=n(78749);function p(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function d(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return p(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:s}}=e;return{value:t,label:n,attributes:a,default:s}}))}(n);return function(e){const t=(0,l.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const s=(0,o.W6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c.aZ)(r),(0,a.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(s.location.search);t.set(r,e),s.replace({...s.location,search:t.toString()})}),[r,s])]}function y(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,r=d(e),[o,c]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:r}))),[l,p]=m({queryString:n,groupId:s}),[y,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,r]=(0,u.Dv)(n);return[s,(0,a.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:s}),b=(()=>{const e=l??y;return h({value:e,tabValues:r})?e:null})();(0,i.A)((()=>{b&&c(b)}),[b]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),p(e),f(e)}),[p,f,r]),tabValues:r}}var f=n(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=n(74848);function _(e){let{className:t,block:n,selectedValue:a,selectValue:o,tabValues:i}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,r.a_)(),u=e=>{const t=e.currentTarget,n=c.indexOf(t),s=i[n].value;s!==a&&(l(t),o(s))},p=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:i.map((e=>{let{value:t,label:n,attributes:r}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{c.push(e)},onKeyDown:p,onClick:u,...r,className:(0,s.A)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function A(e){let{lazy:t,children:n,selectedValue:r}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:o.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r})))})}function x(e){const t=y(e);return(0,g.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,g.jsx)(_,{...t,...e}),(0,g.jsx)(A,{...t,...e})]})}function v(e){const t=(0,f.A)();return(0,g.jsx)(x,{...e,children:p(e.children)},String(t))}},66182:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/create_api_key_community-9cad7e2384395bfdba4f5926727aa56c.png"},67145:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/create_api_key_community_form-ad976a6423f5470bab36622b5b0744d7.png"},79329:(e,t,n)=>{n.d(t,{A:()=>o});n(96540);var a=n(18215);const s={tabItem:"tabItem_Ymn6"};var r=n(74848);function o(e){let{children:t,hidden:n,className:o}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(s.tabItem,o),hidden:n,children:t})}},84681:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/create_api_key_community_2-0fcfc340b618e981bd4627155eeec194.png"}}]);