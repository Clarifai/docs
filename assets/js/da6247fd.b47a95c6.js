"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[8691],{51886:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>b,contentTitle:()=>m,default:()=>w,frontMatter:()=>g,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"integrations/unstructured/dropbox","title":"Chat With Dropbox Using Unstructured.io","description":"Learn how to chat with data from Dropbox","source":"@site/docs/integrations/unstructured/dropbox.md","sourceDirName":"integrations/unstructured","slug":"/integrations/unstructured/dropbox","permalink":"/integrations/unstructured/dropbox","draft":false,"unlisted":false,"editUrl":"https://github.com/Clarifai/docs/blob/main/docs/integrations/unstructured/dropbox.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Data Ingestion Using Unstructured.io","permalink":"/integrations/unstructured/data-ingestion"},"next":{"title":"Use RAG With Unstructured.io","permalink":"/integrations/unstructured/s3-rag"}}');var i=t(74848),o=t(28453),a=t(65537),s=t(79329),l=t(58069);const c="import os  # Importing the os module for environment variable access\n\n# Importing necessary configurations and classes from unstructured.ingest.connector.fsspec.dropbox\nfrom unstructured.ingest.connector.fsspec.dropbox import DropboxAccessConfig, SimpleDropboxConfig\n\n# Importing configuration classes from unstructured.ingest.interfaces\nfrom unstructured.ingest.interfaces import (\n   PartitionConfig,\n   ProcessorConfig,\n   ReadConfig,\n)\n\n# Importing the DropboxRunner class from unstructured.ingest.runner\nfrom unstructured.ingest.runner import DropboxRunner\n\n# Importing necessary configurations and classes from unstructured.ingest.connector.clarifai\nfrom unstructured.ingest.connector.clarifai import (\n   ClarifaiAccessConfig,\n   ClarifaiWriteConfig,\n   SimpleClarifaiConfig,\n)\n\n# Importing base writer and ClarifaiWriter from unstructured.ingest.runner.writers.clarifai\nfrom unstructured.ingest.runner.writers.base_writer import Writer\nfrom unstructured.ingest.runner.writers.clarifai import (\n   ClarifaiWriter,\n)\n",u='def clarifai_writer() -> Writer:\n    # This function defines a writer for the Clarifai service.\n    # It returns an instance of ClarifaiWriter class.\n\n    return ClarifaiWriter(\n        connector_config=SimpleClarifaiConfig(\n            # Configuration for accessing the Clarifai API.\n            access_config=ClarifaiAccessConfig(\n                api_key="PAT"  # API key for accessing the Clarifai service.\n            ),\n            # Configuration specific to the Clarifai application.\n            app_id="app_id",  # The ID of the Clarifai application.\n            user_id="user_id"  # The ID of the Clarifai user.\n        ),\n        write_config=ClarifaiWriteConfig()  # Configuration for writing data to Clarifai.\n    )',d='if __name__ == "__main__":\n    # Creating a writer instance using the clarifai_writer function\n    writer = clarifai_writer()\n    \n    # Creating an instance of DropboxRunner with various configurations\n    runner = DropboxRunner(\n        processor_config=ProcessorConfig(\n            verbose=True,  # Enable verbose output\n            output_dir="dropbox-output",  # Directory to store output locally\n            num_processes=2,  # Number of processes to use\n        ),\n        read_config=ReadConfig(),  # Configuration for reading data\n        partition_config=PartitionConfig(),  # Configuration for partitioning data\n        connector_config=SimpleDropboxConfig(\n            access_config=DropboxAccessConfig(token=os.getenv("DROPBOX_ACCESS_TOKEN")),  # Access config using environment variable for Dropbox token\n            remote_url="dropbox file URL",  # URL of the Dropbox file\n            recursive=True,  # Whether to recursively read files in the directory\n        ),\n        writer=writer,  # Writer to use for output\n        writer_kwargs={},  # Additional arguments for the writer\n    )\n    \n    # Running the DropboxRunner\n    runner.run()\n',p='from clarifai.rag import RAG\n\nWORKFLOW_URL = \'rag_workflow_url\'\n# creating RAG object with prebuilt workflow\nrag_object_from_url = RAG(workflow_url = WORKFLOW_URL)\nresult=rag_object_from_url.chat(messages=[{"role":"human", "content":"what is brake fluid"}])\n# Extract the content of the response and split it by newline character (\'\\n\') into a list \'ans\'.\nanswer = result[0]["content"].split(\'\\n\')\nprint(answer)',h='2024-06-11 10:03:55,063 MainProcess DEBUG    updating download directory to: /root/.cache/unstructured/ingest/dropbox/a5d8d1c6ed\n2024-06-11 10:03:55,068 MainProcess INFO     running pipeline: DocFactory -> Reader -> Partitioner -> Writer -> Copier with config: {"reprocess": false, "verbose": true, "work_dir": "/root/.cache/unstructured/ingest/pipeline", "output_dir": "dropbox-output", "num_processes": 2, "raise_on_error": false}\n2024-06-11 10:03:55,152 MainProcess INFO     Running doc factory to generate ingest docs. Source connector: {"processor_config": {"reprocess": false, "verbose": true, "work_dir": "/root/.cache/unstructured/ingest/pipeline", "output_dir": "dropbox-output", "num_processes": 2, "raise_on_error": false}, "read_config": {"download_dir": "/root/.cache/unstructured/ingest/dropbox/a5d8d1c6ed", "re_download": false, "preserve_downloads": false, "download_only": false, "max_docs": null}, "connector_config": {"remote_url": "dropbox://test", "uncompress": false, "recursive": true, "file_glob": null, "access_config": {"token": "*******"}, "protocol": "dropbox", "path_without_protocol": "test", "dir_path": "test", "file_path": ""}}\n2024-06-11 10:03:55,568 MainProcess INFO     processing 2 docs via 2 processes\n2024-06-11 10:03:55,571 MainProcess INFO     Calling Reader with 2 docs\n2024-06-11 10:03:55,573 MainProcess INFO     Running source node to download data associated with ingest docs\n2024-06-11 10:04:03,339 MainProcess INFO     Calling Partitioner with 2 docs\n2024-06-11 10:04:03,341 MainProcess INFO     Running partition node to extract content from json files. Config: {"pdf_infer_table_structure": false, "strategy": "auto", "ocr_languages": null, "encoding": null, "additional_partition_args": {}, "skip_infer_table_types": null, "fields_include": ["element_id", "text", "type", "metadata", "embeddings"], "flatten_metadata": false, "metadata_exclude": [], "metadata_include": [], "partition_endpoint": "https://api.unstructured.io/general/v0/general", "partition_by_api": false, "api_key": "*******", "hi_res_model_name": null}, partition kwargs: {}]\n2024-06-11 10:04:03,346 MainProcess INFO     Creating /root/.cache/unstructured/ingest/pipeline/partitioned\n2024-06-11 10:04:14,063 MainProcess INFO     Calling Copier with 1 docs\n2024-06-11 10:04:14,067 MainProcess INFO     Running copy node to move content to desired output location\n2024-06-11 10:04:15,970 MainProcess INFO     uploading elements from 1 document(s) to the destination\n2024-06-11 10:04:15,972 MainProcess INFO     Calling Writer with 1 docs\n2024-06-11 10:04:15,975 MainProcess INFO     Running write node to upload content. Destination connector: {"write_config": {"batch_size": 50}, "connector_config": {"access_config": {"api_key": "*******"}, "app_id": "unst-clf", "user_id": "8tzpjy1a841y", "dataset_id": null}, "_client": null}]\n2024-06-11 10:04:16,425 MainProcess INFO     Extending 506 json elements from content in dropbox-output/Crawfords_Auto_Repair_Guide.txt.json\n2024-06-11 10:04:16,445 MainProcess INFO     writing 506 objects to destination app unst-clf \n2024-06-11 10:04:19 INFO     clarifai.client.input:                                                    input.py:706\n                             Inputs Uploaded                                                                       \n                             code: SUCCESS                                                                         \n                             description: "Ok"                                                                     \n                             details: "All inputs successfully added"                                              \n                             req_id: "2216655c3ae641f1b3789c45f367fdd0" \n',f="'Brake fluid is a type of hydraulic fluid used in hydraulic brake and hydraulic clutch applications in vehicles. \nIt is responsible for transferring force into pressure, and to amplify braking force. \nThe level of brake fluid in a vehicle can be checked via a clear reservoir, and it should ideally be between the minimum and maximum level marks. If the fluid is low, it could indicate a potential issue and might require a visit to a mechanic. Most vehicles also have a dashboard light that illuminates when the brake fluid is low.'",g={},m="Chat With Dropbox Using Unstructured.io",b={},x=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initialization",id:"initialization",level:2},{value:"Data Ingestion",id:"data-ingestion",level:2},{value:"Chat",id:"chat",level:2}];function _(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chat-with-dropbox-using-unstructuredio",children:"Chat With Dropbox Using Unstructured.io"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Learn how to chat with data from Dropbox"})}),"\n",(0,i.jsx)("hr",{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://www.dropbox.com/official-teams-page?_tk=paid_sem_goog_biz_b&_camp=1018334849&_kw=dropbox%7Ce&_ad=666300362351%7C%7Cc&gad_source=1&gclid=CjwKCAjw1K-zBhBIEiwAWeCOFw939qj3aTgFRDagZZw0ugD4sLAMy1AeGE_ReqKsEyd5dgMn96KX8RoCzJ4QAvD_BwE",children:"Dropbox"})," is a cloud storage service that allows users to store, sync, and share files online. It provides seamless file synchronization across devices, enabling access to updated files from anywhere with an internet connection. Users can easily share files and folders with others, even if they don't have a Dropbox account.  Using Dropbox as a source connector you can now ingest data to a Clarifai app and then leverage all of Clarifai platform's abilities. In this example, we are going to chat with our data ingested into the Clarifai app using RAG."]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Setting up the Clarifai Python SDK along with PAT. Refer to the installation and configuration with the PAT token ",(0,i.jsx)(n.a,{href:"https://docs.clarifai.com/python-sdk/sdk-overview/",children:"here"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Guide to get your ",(0,i.jsx)(n.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"PAT"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nos.environ['CLARIFAI_PAT'] =\"YOUR_PAT\"\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Install the required packages."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'! pip install "unstructured[clarifai]"\n! pip install "unstructured[dropbox]"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"initialization",children:"Initialization"}),"\n",(0,i.jsx)(n.p,{children:"First, let us setup the data we are going to ingest into the app. The data we are going to use will be stored in Dropbox. To access the data using Unstructured.io, we have to provide Dropbox access token."}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Setup dropbox access token. Refer ",(0,i.jsx)(n.a,{href:"https://developers.dropbox.com/oauth-guide",children:"this"})," page for instructions."]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'DROPBOX_ACCESS_TOKEN="YOUR_ACCESS_TOKEN"\n'})}),"\n",(0,i.jsx)(n.p,{children:"After setting up the access tokens, let\u2019s import some necessary libraries."}),"\n",(0,i.jsx)(a.A,{children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:c})})}),"\n",(0,i.jsx)(n.p,{children:"Next, we will have to write a function to set up the ingestion configurations required to upload the data into our app in the Clarifai platform."}),"\n",(0,i.jsx)(a.A,{children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:u})})}),"\n",(0,i.jsx)(n.h2,{id:"data-ingestion",children:"Data Ingestion"}),"\n",(0,i.jsx)(n.p,{children:"In data ingestion, there are two important concepts Source Connector and Destination Connector. For our use case the Source Connector will fetch the data from Dropbox and the Destination Connector will send the transformed data to the Clarifai app."}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.a,{href:"https://unstructured-io.github.io/unstructured/ingest/index.html",children:"here"})," to learn more about Ingestion."]}),"\n",(0,i.jsx)(a.A,{children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:d})})}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Output"}),(0,i.jsx)(l.A,{className:"language-python",children:h})]}),"\n",(0,i.jsx)(n.h2,{id:"chat",children:"Chat"}),"\n",(0,i.jsx)(n.p,{children:"In the final step, we are going to perform information retrieval using RAG based on the data we ingested from Dropbox to the Clarifai app using Unstructured.io. You can use a workflow with a RAG prompter for initialising RAG. After successfully creating a workflow, you can get the URL from the Clarifai portal. After creating the rag object using workflow URL you can start retrieving text from the data we ingested using Unstructured.io."}),"\n",(0,i.jsx)(a.A,{children:(0,i.jsx)(s.A,{value:"python",label:"Python",children:(0,i.jsx)(l.A,{className:"language-python",children:p})})}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Output"}),(0,i.jsx)(l.A,{className:"language-python",children:f})]})]})}function w(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(_,{...e})}):_(e)}},65537:(e,n,t)=>{t.d(n,{A:()=>C});var r=t(96540),i=t(18215),o=t(65627),a=t(56347),s=t(50372),l=t(30604),c=t(11861),u=t(78749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:t}=e;const i=(0,a.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(i.location.search);n.set(o,e),i.replace({...i.location,search:n.toString()})}),[o,i])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,o=p(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[c,d]=f({queryString:t,groupId:i}),[g,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,o]=(0,u.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:i}),b=(()=>{const e=c??g;return h({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{b&&l(b)}),[b]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,o]),tabValues:o}}var m=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function _(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),i=s[t].value;i!==r&&(c(n),a(i))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:s.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...o,className:(0,i.A)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:o}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function v(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,i.A)("tabs-container",b.tabList),children:[(0,x.jsx)(_,{...n,...e}),(0,x.jsx)(w,{...n,...e})]})}function C(e){const n=(0,m.A)();return(0,x.jsx)(v,{...e,children:d(e.children)},String(n))}},79329:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var r=t(18215);const i={tabItem:"tabItem_Ymn6"};var o=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,a),hidden:t,children:n})}}}]);