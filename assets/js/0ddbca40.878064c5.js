"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[8465],{65075:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>w,contentTitle:()=>j,default:()=>y,frontMatter:()=>_,metadata:()=>r,toc:()=>b});const r=JSON.parse('{"id":"integrations/unstructured/salesforce","title":"Ingest Email Messages From Salesforce Using Unstructured.io","description":"Learn how to ingest email messages from Salesforce","source":"@site/docs/integrations/unstructured/salesforce.md","sourceDirName":"integrations/unstructured","slug":"/integrations/unstructured/salesforce","permalink":"/integrations/unstructured/salesforce","draft":false,"unlisted":false,"editUrl":"https://github.com/Clarifai/docs/blob/main/docs/integrations/unstructured/salesforce.md","tags":[],"version":"current","frontMatter":{"description":"Learn how to ingest email messages from Salesforce","pagination_next":null},"sidebar":"tutorialSidebar","previous":{"title":"Use RAG With Unstructured.io","permalink":"/integrations/unstructured/s3-rag"}}');var s=t(74848),a=t(28453),i=t(65537),o=t(79329),l=t(58069);const c="import os  # Importing the os module for environment variable access\n\n# Importing necessary configurations and classes from unstructured.ingest.connector.salesforce\nfrom unstructured.ingest.connector.salesforce import SalesforceAccessConfig, SimpleSalesforceConfig\n\n# Importing configuration classes from unstructured.ingest.interfaces\nfrom unstructured.ingest.interfaces import PartitionConfig, ProcessorConfig, ReadConfig\n\n# Importing the SalesforceRunner class from unstructured.ingest.runner\nfrom unstructured.ingest.runner import SalesforceRunner\n\n# Importing necessary configurations and classes from unstructured.ingest.connector.clarifai\nfrom unstructured.ingest.connector.clarifai import (\n    ClarifaiAccessConfig,\n    ClarifaiWriteConfig,\n    SimpleClarifaiConfig,\n)\n\n# Importing base writer and ClarifaiWriter from unstructured.ingest.runner.writers.clarifai\nfrom unstructured.ingest.runner.writers.base_writer import Writer\nfrom unstructured.ingest.runner.writers.clarifai import ClarifaiWriter",u='def clarifai_writer() -> Writer:\n    # This function defines a writer for the Clarifai service.\n    # It returns an instance of ClarifaiWriter class.\n\n    return ClarifaiWriter(\n        connector_config=SimpleClarifaiConfig(\n            # Configuration for accessing the Clarifai API.\n            access_config=ClarifaiAccessConfig(\n                api_key="PAT"  # API key for accessing the Clarifai service.\n            ),\n            # Configuration specific to the Clarifai application.\n            app_id="app_id",  # The ID of the Clarifai application.\n            user_id="user_id"  # The ID of the Clarifai user.\n        ),\n        write_config=ClarifaiWriteConfig()  # Configuration for writing data to Clarifai.\n    )',d='if __name__ == "__main__":\n    # Creating a writer instance using the clarifai_writer function\n    writer = clarifai_writer()\n    \n    # Creating an instance of SalesforceRunner with various configurations\n    runner = SalesforceRunner(\n        processor_config=ProcessorConfig(\n            verbose=True,  # Enable verbose output\n            output_dir="salesforce-output",  # Directory to store output locally\n            num_processes=2,  # Number of processes to use\n        ),\n        read_config=ReadConfig(),  # Configuration for reading data\n        partition_config=PartitionConfig(),  # Configuration for partitioning data\n        connector_config=SimpleSalesforceConfig(\n            access_config=SalesforceAccessConfig(\n                consumer_key="YOUR_SALESFORCE_CONSUMER_KEY",  # Salesforce consumer key\n                private_key="PATH_TO_server.key_FILE",  # Path to the private key file\n            ),\n            username="SALESFORCE_USERNAME",  # Salesforce username\n            categories=["EmailMessage"],  # Categories to read data from\n            recursive=True,  # Whether to recursively read data\n        ),\n        writer=writer,  # Writer to use for output\n        writer_kwargs={},  # Additional arguments for the writer\n    )\n    \n    # Running the SalesforceRunner\n    runner.run()',f='from clarifai.rag import RAG\n\nWORKFLOW_URL = \'rag_workflow_url\'\n# creating RAG object with prebuilt workflow\nrag_object_from_url = RAG(workflow_url = WORKFLOW_URL)\n\nresult=rag_object_from_url.chat(messages=[{"role":"human", "content":"Summarize emails send to Wayne_llc "}])\n\nanswer = result[0]["content"].split(\'\\n\')\nprint(answer)',p='result=rag_object_from_url.chat(messages=[{"role":"human", "content":"What kind of product does Stark llc sell "}])\n\nanswer = result[0]["content"].split(\'\\n\')\nprint(answer)',g='2024-06-12 09:15:19,685 MainProcess DEBUG    updating download directory to: /root/.cache/unstructured/ingest/salesforce/54298b8afd\n2024-06-12 09:15:19,690 MainProcess INFO     running pipeline: DocFactory -> Reader -> Partitioner -> Writer -> Copier with config: {"reprocess": false, "verbose": true, "work_dir": "/root/.cache/unstructured/ingest/pipeline", "output_dir": "salesforce-output", "num_processes": 2, "raise_on_error": false}\n2024-06-12 09:15:19,785 MainProcess INFO     Running doc factory to generate ingest docs. Source connector: {"processor_config": {"reprocess": false, "verbose": true, "work_dir": "/root/.cache/unstructured/ingest/pipeline", "output_dir": "salesforce-output", "num_processes": 2, "raise_on_error": false}, "read_config": {"download_dir": "/root/.cache/unstructured/ingest/salesforce/54298b8afd", "re_download": false, "preserve_downloads": false, "download_only": false, "max_docs": null}, "connector_config": {"access_config": {"consumer_key": "*******", "private_key": "*******"}, "categories": ["EmailMessage"], "username": "adithyansukumar@testing.com", "recursive": true}}\n2024-06-12 09:15:21,944 MainProcess INFO     processing 14 docs via 2 processes\n2024-06-12 09:15:21,951 MainProcess INFO     Calling Reader with 14 docs\n2024-06-12 09:15:21,953 MainProcess INFO     Running source node to download data associated with ingest docs\n2024-06-12 09:15:40,018 MainProcess INFO     Calling Partitioner with 14 docs\n2024-06-12 09:15:40,021 MainProcess INFO     Running partition node to extract content from json files. Config: {"pdf_infer_table_structure": false, "strategy": "auto", "ocr_languages": null, "encoding": null, "additional_partition_args": {}, "skip_infer_table_types": null, "fields_include": ["element_id", "text", "type", "metadata", "embeddings"], "flatten_metadata": false, "metadata_exclude": [], "metadata_include": [], "partition_endpoint": "https://api.unstructured.io/general/v0/general", "partition_by_api": false, "api_key": "*******", "hi_res_model_name": null}, partition kwargs: {}]\n2024-06-12 09:15:40,024 MainProcess INFO     Creating /root/.cache/unstructured/ingest/pipeline/partitioned\n2024-06-12 09:15:48,787 MainProcess INFO     Calling Copier with 14 docs\n2024-06-12 09:15:48,790 MainProcess INFO     Running copy node to move content to desired output location\n2024-06-12 09:15:52,096 MainProcess INFO     uploading elements from 14 document(s) to the destination\n2024-06-12 09:15:52,098 MainProcess INFO     Calling Writer with 14 docs\n2024-06-12 09:15:52,102 MainProcess INFO     Running write node to upload content. Destination connector: {"write_config": {"batch_size": 50}, "connector_config": {"access_config": {"api_key": "*******"}, "app_id": "salesforce_app_3", "user_id": "8tzpjy1a841y", "dataset_id": null}, "_client": null}]\n2024-06-12 09:15:52,442 MainProcess INFO     Extending 3 json elements from content in salesforce-output/EmailMessage/02sdL000000BwlRQAS.eml.json\n2024-06-12 09:15:52,443 MainProcess INFO     Extending 2 json elements from content in salesforce-output/EmailMessage/02sdL000000By7JQAS.eml.json\n2024-06-12 09:15:52,447 MainProcess INFO     Extending 22 json elements from content in salesforce-output/EmailMessage/02sdL000000ByYjQAK.eml.json\n2024-06-12 09:15:52,450 MainProcess INFO     Extending 1 json elements from content in salesforce-output/EmailMessage/02sdL000000CJIDQA4.eml.json\n2024-06-12 09:15:52,453 MainProcess INFO     Extending 10 json elements from content in salesforce-output/EmailMessage/02sdL000000DGQMQA4.eml.json\n2024-06-12 09:15:52,455 MainProcess INFO     Extending 10 json elements from content in salesforce-output/EmailMessage/02sdL000000DGetQAG.eml.json\n2024-06-12 09:15:52,456 MainProcess INFO     Extending 10 json elements from content in salesforce-output/EmailMessage/02sdL000000DGwbQAG.eml.json\n2024-06-12 09:15:52,458 MainProcess INFO     Extending 9 json elements from content in salesforce-output/EmailMessage/02sdL000000DGyDQAW.eml.json\n2024-06-12 09:15:52,460 MainProcess INFO     Extending 11 json elements from content in salesforce-output/EmailMessage/02sdL000000DGzpQAG.eml.json\n2024-06-12 09:15:52,462 MainProcess INFO     Extending 11 json elements from content in salesforce-output/EmailMessage/02sdL000000DH1RQAW.eml.json\n2024-06-12 09:15:52,463 MainProcess INFO     Extending 12 json elements from content in salesforce-output/EmailMessage/02sdL000000DH33QAG.eml.json\n2024-06-12 09:15:52,465 MainProcess INFO     Extending 9 json elements from content in salesforce-output/EmailMessage/02sdL000000DH9VQAW.eml.json\n2024-06-12 09:15:52,466 MainProcess INFO     Extending 11 json elements from content in salesforce-output/EmailMessage/02sdL000000DHB7QAO.eml.json\n2024-06-12 09:15:52,468 MainProcess INFO     Extending 11 json elements from content in salesforce-output/EmailMessage/02sdL000000DHHZQA4.eml.json\n2024-06-12 09:15:52,475 MainProcess INFO     writing 132 objects to destination app salesforce_app_3 \n2024-06-12 09:15:55 INFO     clarifai.client.input:                                                    input.py:706\n                             Inputs Uploaded                                                                       \n                             code: SUCCESS                                                                         \n                             description: "Ok"                                                                     \n                             details: "All inputs successfully added"                                              \n                             req_id: "af1aca7b33bf498e898c859c47259ef4"\n',h="'The email sent to Wayne LLC was from jane.doe@xyzhospitality.com. In her email, she mentioned that they have reviewed their inventory and are interested in placing a new order. She requested for an updated product catalog and availability list. Additionally, she also asked if there are any new products or special offers that they should be aware of.'",m="'Stark LLC sells office furniture, including Modular Office Furniture Sets and Office Chairs.'",_={description:"Learn how to ingest email messages from Salesforce",pagination_next:null},j="Ingest Email Messages From Salesforce Using Unstructured.io",w={},b=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initialization",id:"initialization",level:2},{value:"Data Ingestion",id:"data-ingestion",level:2},{value:"Chat",id:"chat",level:2}];function x(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ingest-email-messages-from-salesforce-using-unstructuredio",children:"Ingest Email Messages From Salesforce Using Unstructured.io"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Learn how to ingest email messages from Salesforce"})}),"\n",(0,s.jsx)("hr",{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.salesforce.com/in/",children:"Salesforce"})," is a cloud-based customer relationship management (CRM) platform that assists businesses in managing their relationships and interactions with customers and prospects. It offers a comprehensive suite of tools including Sales Cloud, Service Cloud, Marketing Cloud, Commerce Cloud, and Analytics Cloud, among others, to streamline various business processes. In Salesforce, email messages play a crucial role in customer communication and interaction tracking. The platform integrates seamlessly with popular email services like Outlook and Gmail through Salesforce Inbox, allowing users to log emails directly into Salesforce. Additionally, Salesforce supports the creation of email templates, enabling consistent and personalized communication using merge fields from Salesforce records.  In this tutorial, we are going to ingest the email messages from Salesforce to the Clarifai app and then use LLM to classify and summarize emails."]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Setting up the Clarifai Python SDK along with PAT. Refer to the installation and configuration with the PAT token ",(0,s.jsx)(n.a,{href:"https://docs.clarifai.com/python-sdk/sdk-overview/",children:"here"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Guide to get your ",(0,s.jsx)(n.a,{href:"https://docs.clarifai.com/clarifai-basics/authentication/personal-access-tokens",children:"PAT"})]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import os\nos.environ['CLARIFAI_PAT'] =\"YOUR_PAT\"\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Install the required packages."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'! pip install "unstructured[clarifai]" \n! pip install "unstructured[salesforce]"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Setup JWT authorization in Salesforce. Refer ",(0,s.jsx)(n.a,{href:"https://developer.salesforce.com/docs/atlas.en-us.sfdx_dev.meta/sfdx_dev/sfdx_dev_auth_key_and_cert.htm",children:"this"})," page for instructions."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"initialization",children:"Initialization"}),"\n",(0,s.jsx)(n.p,{children:"The data we are going to ingest into our app is the body of the email messages in Salesforce. Since we have already set the JWT authorization for Salesforce let\u2019s import some required libraries,"}),"\n",(0,s.jsx)(i.A,{groupId:"code",children:(0,s.jsx)(o.A,{value:"python",label:"Python",children:(0,s.jsx)(l.A,{className:"language-python",children:c})})}),"\n",(0,s.jsx)(n.p,{children:"Next we will have to write a function to setup the ingestion configurations required to upload the data into our app in the Clarifai platform."}),"\n",(0,s.jsx)(i.A,{groupId:"code",children:(0,s.jsx)(o.A,{value:"python",label:"Python",children:(0,s.jsx)(l.A,{className:"language-python",children:u})})}),"\n",(0,s.jsx)(n.h2,{id:"data-ingestion",children:"Data Ingestion"}),"\n",(0,s.jsx)(n.p,{children:"In data ingestion, there are two important concepts, Source Connector and Destination Connector. For our use case the Source Connector will fetch the data from Salesforce and the Destination Connector will send the transformed data to the Clarifai app."}),"\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.a,{href:"https://unstructured-io.github.io/unstructured/ingest/index.html",children:"here"})," to learn more about Ingestion."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"SalesforceAccessConfig"}),", the category is set as ",(0,s.jsx)(n.code,{children:"EmailMessage"})," for this task. Unstructured.io also supports other fields like ",(0,s.jsx)(n.code,{children:"Account"}),", ",(0,s.jsx)(n.code,{children:"Case"}),", ",(0,s.jsx)(n.code,{children:"Campaign"}),", and ",(0,s.jsx)(n.code,{children:"Lead"})," ."]})}),"\n",(0,s.jsx)(i.A,{groupId:"code",children:(0,s.jsx)(o.A,{value:"python",label:"Python",children:(0,s.jsx)(l.A,{className:"language-python",children:d})})}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Output"}),(0,s.jsx)(l.A,{className:"language-python",children:g})]}),"\n",(0,s.jsx)(n.h2,{id:"chat",children:"Chat"}),"\n",(0,s.jsx)(n.p,{children:"In the final step, we are going to chat with the data using RAG. You can use a workflow with a RAG prompter for initialising RAG. After successfully creating a workflow, you can get the URL from the Clarifai portal. After creating the rag object using workflow URL you can start retrieving text from the data we ingested using Unstructured.io."}),"\n",(0,s.jsx)(i.A,{groupId:"code",children:(0,s.jsx)(o.A,{value:"python",label:"Python",children:(0,s.jsx)(l.A,{className:"language-python",children:f})})}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Output"}),(0,s.jsx)(l.A,{className:"language-python",children:h})]}),"\n",(0,s.jsx)(i.A,{groupId:"code",children:(0,s.jsx)(o.A,{value:"python",label:"Python",children:(0,s.jsx)(l.A,{className:"language-python",children:p})})}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Output"}),(0,s.jsx)(l.A,{className:"language-python",children:m})]})]})}function y(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},65537:(e,n,t)=>{t.d(n,{A:()=>y});var r=t(96540),s=t(18215),a=t(65627),i=t(56347),o=t(50372),l=t(30604),c=t(11861),u=t(78749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function f(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const s=(0,i.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(s.location.search);n.set(a,e),s.replace({...s.location,search:n.toString()})}),[a,s])]}function h(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,a=f(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[c,d]=g({queryString:t,groupId:s}),[h,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,a]=(0,u.Dv)(t);return[s,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:s}),_=(()=>{const e=c??h;return p({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{_&&l(_)}),[_]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,a]),tabValues:a}}var m=t(9136);const _={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(74848);function w(e){let{className:n,block:t,selectedValue:r,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),s=o[t].value;s!==r&&(c(n),i(s))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...a,className:(0,s.A)("tabs__item",_.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function b(e){let{lazy:n,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function x(e){const n=h(e);return(0,j.jsxs)("div",{className:(0,s.A)("tabs-container",_.tabList),children:[(0,j.jsx)(w,{...n,...e}),(0,j.jsx)(b,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,j.jsx)(x,{...e,children:d(e.children)},String(n))}},79329:(e,n,t)=>{t.d(n,{A:()=>i});t(96540);var r=t(18215);const s={tabItem:"tabItem_Ymn6"};var a=t(74848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,i),hidden:t,children:n})}}}]);